class L{static waitForFontsLoaded(){return new Promise(t=>{document.fonts&&document.fonts.ready?document.fonts.ready.then(()=>{setTimeout(t,50)}).catch(()=>{t()}):setTimeout(t,200)})}static waitForImagesLoaded(t="img"){return new Promise(e=>{const a=document.querySelectorAll(t);if(a.length===0){e();return}let n=0;const i=a.length;let s=!1;const o=()=>{n++,n>=i&&!s&&(s=!0,setTimeout(e,100))};a.forEach(l=>{l.complete&&l.naturalHeight!==0?o():(l.addEventListener("load",o,{once:!0}),l.addEventListener("error",o,{once:!0}))}),setTimeout(()=>{s||(s=!0,e())},3e3)})}static waitForPageReady(t="img"){return new Promise(e=>{document.readyState==="complete"?Promise.all([this.waitForImagesLoaded(t),this.waitForFontsLoaded()]).then(()=>e()):window.addEventListener("load",()=>{Promise.all([this.waitForImagesLoaded(t),this.waitForFontsLoaded()]).then(()=>e())},{once:!0})})}}class P{static setActiveNavigationLink(t){const e=document.querySelectorAll(`${t} .cta-button`);let a=window.location.pathname.split("/").pop();(a===""||a==="index.html"||window.location.pathname==="/")&&(a="index.html"),e.forEach(n=>{let i=n.getAttribute("href").split("/").pop();(i===""||n.getAttribute("href")==="/"||i==="index.html")&&(i="index.html"),i===a?n.classList.add("active"):n.classList.remove("active")})}}class E{constructor(t,e=".page-wrapper"){this.navigationSelector=t,this.pageWrapperSelector=e,this.menuButton=null,this.navigationSection=null,this.pageWrapper=null,this.isInitialized=!1}init(){this.isInitialized||(this.navigationSection=document.querySelector(this.navigationSelector),this.pageWrapper=document.querySelector(this.pageWrapperSelector),!(!this.navigationSection||!this.pageWrapper)&&this.waitForMenuButton())}waitForMenuButton(){let t=0;const e=20,a=()=>{if(this.menuButton=document.querySelector(".header-menu-button"),!this.menuButton){if(t++,t>=e){console.warn("Кнопка меню не найдена после ожидания");return}setTimeout(a,50);return}const n=`${this.navigationSelector.replace(/[^a-zA-Z0-9]/g,"_")}_scroll_handler`;this.menuButton.dataset[n]!=="true"&&(this.menuButton.addEventListener("click",()=>{const i=document.querySelector(".footer");if(i)i.scrollIntoView({behavior:"smooth",block:"end"});else{const s=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);window.scrollTo({top:s,behavior:"smooth"})}}),this.menuButton.dataset[n]="true",this.isInitialized=!0)};a()}}class w{constructor(){this.currentLanguage="ru",this.translations={},this.listeners=new Set}isUserFromCIS(){const t=navigator.language||navigator.userLanguage||"",e=["ru","uk","be","kk","uz","hy","az","ky","tg","tk","mo"];if(e.some(a=>t.toLowerCase().startsWith(a)))return!0;if(navigator.languages){for(const a of navigator.languages)if(e.some(n=>a.toLowerCase().startsWith(n)))return!0}try{const a=Intl.DateTimeFormat().resolvedOptions().timeZone;if(["Europe/Moscow","Europe/Minsk","Asia/Almaty","Asia/Bishkek","Asia/Yerevan","Asia/Baku","Europe/Chisinau","Asia/Dushanbe","Asia/Tashkent","Asia/Ashgabat","Europe/Kiev","Europe/Kyiv"].includes(a))return!0}catch{}return!1}detectDefaultLanguage(){const t=localStorage.getItem("language");return t==="ru"||t==="en"?t:this.isUserFromCIS()?"ru":"en"}async init(t=null){t||(t=this.detectDefaultLanguage()),this.currentLanguage=t,await this.loadTranslations(this.currentLanguage)}async loadTranslations(t){try{const e=await fetch(`/data/locales/${t}.json`);if(!e.ok)throw new Error(`Failed to load translations for ${t}`);this.translations=await e.json(),this.currentLanguage=t,localStorage.setItem("language",t),document.documentElement.lang=t,navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(document.body.style.fontSize=getComputedStyle(document.body).fontSize,requestAnimationFrame(()=>{document.body.style.fontSize=""})),this.notifyListeners()}catch(e){console.error("Error loading translations:",e),t!=="ru"&&await this.loadTranslations("ru")}}t(t,e={},a=!1){const n=t.split(".");let i=this.translations;for(const s of n)if(i&&typeof i=="object"&&s in i)i=i[s];else return!a&&Object.keys(this.translations).length>0&&console.warn(`Translation key not found: ${t}`),t;return typeof i!="string"?(!a&&Object.keys(this.translations).length>0&&console.warn(`Translation value is not a string: ${t}`),t):Object.keys(e).length>0?i.replace(/\{\{(\w+)\}\}/g,(s,o)=>e[o]!==void 0?e[o]:s):i}getCurrentLanguage(){return this.currentLanguage}async switchLanguage(t){t!==this.currentLanguage&&await this.loadTranslations(t)}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){this.listeners.forEach(t=>{try{t(this.currentLanguage,this.translations)}catch(e){console.error("Error in localization listener:",e)}})}}const d=new w;function h(r,t){return typeof window>"u"||!document.documentElement?t:getComputedStyle(document.documentElement).getPropertyValue(`--${r}`).trim()||t}function S(r){const t=r.match(/^([\d.]+)(s|ms)$/);if(!t)return 300;const e=parseFloat(t[1]);return t[2]==="s"?e*1e3:e}const c={get duration(){return h("transition-duration-base","0.3s")},get timing(){return h("timing-function-ease-in-out","ease-in-out")},translateYAppear:"10px",translateYDisappear:"-10px",translateYFinal:"0",get timeout(){return S(this.duration)}};function A(r,t={}){if(!r)return;const e={duration:t.duration||c.duration,timing:t.timing||c.timing,translateYAppear:t.translateYAppear||c.translateYAppear,translateYFinal:t.translateYFinal||c.translateYFinal,timeout:t.timeout||c.timeout,skipInitialState:t.skipInitialState||!1};r.style.display==="none"&&(r.style.display=""),e.skipInitialState||(r.style.opacity="0",r.style.transform=`translateY(${e.translateYAppear})`,r.style.transition="none",r.offsetHeight),requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(!e.skipInitialState)r.style.opacity="0",r.style.transform=`translateY(${e.translateYAppear})`,r.style.transition="none";else{const a=window.getComputedStyle(r),n=parseFloat(a.opacity),i=r.style.opacity,s=r.style.transform,o=r.style.transition;(n>.01||!i||i===""||!s||s===""||o&&o!=="none")&&(r.style.setProperty("opacity","0","important"),r.style.setProperty("transform",`translateY(${e.translateYAppear})`,"important"),r.style.setProperty("transition","none","important"),r.offsetHeight)}requestAnimationFrame(()=>{const a=window.getComputedStyle(r),n=parseFloat(a.opacity),i=r.style.opacity,s=r.style.transform;(n>.01||!i||i===""||!s||s==="")&&(r.style.setProperty("opacity","0","important"),r.style.setProperty("transform",`translateY(${e.translateYAppear})`,"important"),r.style.setProperty("transition","none","important"),r.offsetHeight),r.style.removeProperty("transition"),r.style.transition=`opacity ${e.duration} ${e.timing}, transform ${e.duration} ${e.timing}`,r.offsetHeight,r.style.removeProperty("opacity"),r.style.removeProperty("transform"),r.style.opacity="1",r.style.transform=`translateY(${e.translateYFinal})`,setTimeout(()=>{r.style.removeProperty("transform"),r.style.removeProperty("opacity"),r.style.removeProperty("transition")},e.timeout)})})})}function Y(r,t={}){if(!r||r.length===0)return;const e=Array.isArray(r)?r:Array.from(r),a=t.translateYAppear||c.translateYAppear,n=t.skipInitialState||!1;n||(e.forEach(i=>{i&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform",`translateY(${a})`,"important"),i.style.setProperty("transition","none","important"))}),e.length>0&&e[0]&&e[0].offsetHeight),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.forEach(i=>{if(i)if(n){const s=window.getComputedStyle(i),o=parseFloat(s.opacity),l=i.style.opacity,u=i.style.transform;(o>.01||!l||l===""||!u||u==="")&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform",`translateY(${a})`,"important"),i.style.setProperty("transition","none","important"))}else i.style.setProperty("opacity","0","important"),i.style.setProperty("transform",`translateY(${a})`,"important"),i.style.setProperty("transition","none","important")}),e.length>0&&e[0]&&e[0].offsetHeight,requestAnimationFrame(()=>{const i={duration:t.duration||c.duration,timing:t.timing||c.timing,translateYFinal:t.translateYFinal||c.translateYFinal,timeout:t.timeout||c.timeout};e.forEach(s=>{s&&(s.style.removeProperty("transition"),s.style.transition=`opacity ${i.duration} ${i.timing}, transform ${i.duration} ${i.timing}`)}),e.length>0&&e[0]&&e[0].offsetHeight,e.forEach(s=>{s&&(s.style.removeProperty("opacity"),s.style.removeProperty("transform"),s.style.opacity="1",s.style.transform=`translateY(${i.translateYFinal})`)}),setTimeout(()=>{e.forEach(s=>{s&&(s.style.removeProperty("transform"),s.style.removeProperty("opacity"),s.style.removeProperty("transition"))})},i.timeout)})})})}function I(r,t={}){if(!r)return;const e={duration:t.duration||c.duration,timing:t.timing||c.timing,translateYAppear:t.translateYAppear||c.translateYAppear,translateYFinal:t.translateYFinal||c.translateYFinal,timeout:t.timeout||c.timeout};r.style.visibility="visible",r.style.display=r.style.display||"block",A(r,e)}const f=new Map,p=new Map,b=300*1e3;async function T(r,t={}){const e=f.get(r);if(e){const{data:n,timestamp:i}=e;if(Date.now()-i<b)return Promise.resolve(n);f.delete(r)}if(p.has(r))return p.get(r);const a=fetch(r,{...t,priority:t.priority||"high",cache:t.cache||"default",headers:{"Cache-Control":"max-age=300",...t.headers}}).then(async n=>{if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();return f.set(r,{data:i,timestamp:Date.now()}),i}).catch(n=>{throw console.error(`Ошибка загрузки данных из ${r}:`,n),n}).finally(()=>{p.delete(r)});return p.set(r,a),a}async function D(r,t,e){if(!e)throw new Error("loadHTMLFunction is required");try{const a=await e(r),n=document.createElement("div");n.innerHTML=a;const i=t&&n.querySelector(t)||n.firstElementChild;return i||(console.error(`Не удалось найти элемент в шаблоне ${r} по селектору ${t||"firstElementChild"}`),null)}catch(a){return console.error(`Ошибка загрузки шаблона ${r}:`,a),null}}function m(){if(typeof CSS<"u"&&CSS.supports)return CSS.supports("height","1dvh");try{const r=document.createElement("div");return r.style.height="1dvh",r.style.height==="1dvh"}catch{return!1}}function y(){const r=window.innerHeight*.01;document.documentElement.style.setProperty("--vh-fallback",`${r}px`)}function $(r,t){let e;return function(...n){const i=()=>{clearTimeout(e),r(...n)};clearTimeout(e),e=setTimeout(i,t)}}let g=!1;const v=$(y,150);function k(){if(g)return{supportsDvh:m(),message:"Already initialized"};const r=m();return r?(y(),window.addEventListener("resize",v,{passive:!0})):(y(),window.addEventListener("resize",v,{passive:!0}),"orientation"in window&&window.addEventListener("orientationchange",()=>{setTimeout(y,100)},{passive:!0})),g=!0,{supportsDvh:r,message:r?"Using native dvh support":"Using JavaScript fallback for viewport height"}}class C{static hideElementsForAnimation(t,e={}){const a={opacity:e.opacity||"0",transform:e.transform||"translateY(10px)",important:e.important!==!1};(Array.isArray(t)?t:Array.from(t)).forEach(i=>{i&&(a.important?(i.style.setProperty("opacity",a.opacity,"important"),i.style.setProperty("transform",a.transform,"important"),i.style.setProperty("transition","none","important")):(i.style.opacity=a.opacity,i.style.transform=a.transform,i.style.transition="none"))})}static isElementVisible(t){if(!t)return!1;const e=window.getComputedStyle(t),a=parseFloat(e.opacity),n=e.visibility,i=e.display;return a>.01&&n!=="hidden"&&i!=="none"}static forceReflow(t){t&&t.offsetHeight}static clearAnimationStyles(t){(Array.isArray(t)?t:Array.from(t)).forEach(a=>{a&&(a.style.removeProperty("opacity"),a.style.removeProperty("transform"),a.style.removeProperty("transition"))})}}function M(r,t=!1,e=null){const n={solo:t?"soloDetailed":"solo","team-lead":t?"teamLeadDetailed":"teamLead",team:"team"}[r];let i=n?d.t(`roles.${n}`):r;if(e&&r==="team-lead"&&t){const s=d.t("roles.teamName");i=`${i} (${s} ${e})`}return i}class z{static getStatusText(t){const a={published:"published","in-publication":"inPublication","in-progress":"inProgress"}[t];return a?d.t(`research.statuses.${a}`):t}static getTypeText(t){const a={thesis:"thesis",article:"article",diploma:"diploma"}[t];return a?d.t(`research.types.${a}`):t}}class F{constructor(){this.observer=null,this.observedImages=new WeakSet}initObserver(){this.observer||(this.observer=new IntersectionObserver(t=>{t.forEach(e=>{if(e.isIntersecting){const a=e.target,n=a.dataset.src;n&&(a.hasAttribute("loading")||(a.loading="lazy"),a.src=n,a.removeAttribute("data-src"),this.observer.unobserve(a),this.observedImages.delete(a))}})},{rootMargin:"150px",threshold:.01}))}loadImage(t){!t||!t.dataset.src||this.observedImages.has(t)||t.src&&!t.dataset.src||(this.initObserver(),this.observer.observe(t),this.observedImages.add(t))}loadAllImages(){document.querySelectorAll("img[data-src]").forEach(e=>this.loadImage(e))}disconnect(){this.observer&&(this.observer.disconnect(),this.observer=null),this.observedImages=new WeakSet}}const H=new F;class x{static formatPeriod(t,e="ru"){if(!t)return"";let a=t.start||"",n=t.end||(e==="en"?"present":"настоящее время");if(e==="en"){const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(a&&a.match(/^\d{4}-\d{2}$/)){const[o,l]=a.split("-"),u=parseInt(l,10)-1;a=`${s[u]} ${o}`}else a&&a.match(/^\d{4}$/)&&(a=a);if(n&&n.match(/^\d{4}-\d{2}$/)){const[o,l]=n.split("-"),u=parseInt(l,10)-1;n=`${s[u]} ${o}`}else n&&n.match(/^\d{4}$/)&&(n=n)}let i="";return t.durationLocalized&&t.durationLocalized[e]?i=` (${t.durationLocalized[e]})`:t.duration&&(i=` (${t.duration})`),`${a} — ${n}${i}`}static formatDate(t){if(!t)return"";if(t.year)return t.year.toString();if(t.start&&t.end){const e=new Date(t.start),a=new Date(t.end);return`${e.getDate()}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()} — ${a.getDate()}.${String(a.getMonth()+1).padStart(2,"0")}.${a.getFullYear()}`}if(t.start){const e=new Date(t.start);return`${e.getDate()}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`}return""}static getYearFromDate(t){return t.year?t.year:t.start?new Date(t.start).getFullYear():t.end?new Date(t.end).getFullYear():null}}export{c as A,x as D,E as M,P as N,L as P,z as S,Y as a,A as b,H as c,I as d,T as e,D as f,M as g,C as h,k as i,d as l};
