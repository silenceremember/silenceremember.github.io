class o{constructor(t,i){this.loadingId=t,this.containerId=i,this.loadingElement=null,this.container=null}init(){this.loadingElement=document.getElementById(this.loadingId),this.container=document.getElementById(this.containerId)}hide(){return new Promise(t=>{if(this.loadingElement||this.init(),!this.loadingElement){t();return}const i=window.getComputedStyle(this.loadingElement);if(!(i.display!=="none"&&i.visibility!=="hidden"&&parseFloat(i.opacity)>.01)){this.loadingElement.parentNode&&this.loadingElement.remove(),this.container&&(this.container.style.visibility="",this.container.style.opacity=""),t();return}this.container&&this.container.contains(this.loadingElement),this.loadingElement.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",this.loadingElement.style.opacity="1",this.loadingElement.style.transform="translateY(0)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.loadingElement.style.opacity="0",this.loadingElement.style.transform="translateY(-10px)"})}),setTimeout(()=>{this.loadingElement.parentNode&&this.loadingElement.remove();const e=this.container&&(this.container.id==="projects-grid"||this.container.id==="research-publications-section"||this.container.classList.contains("projects-grid")||this.container.classList.contains("research-publications-section"));this.container&&(e?(this.container.style.visibility="",this.container.style.opacity="",this.container.style.pointerEvents="",this.container.style.display=""):(this.container.style.display="none",this.container.style.pointerEvents="none",this.container.style.visibility="hidden",this.container.style.opacity="0")),t()},300)})}show(){if(this.container||this.init(),!this.container)return;let t=document.getElementById(this.loadingId);this.container.children.length>0&&(!t||this.container.children.length>1||!this.container.contains(t))?(this.container.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",this.container.style.opacity="1",this.container.style.transform="translateY(0)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.container.style.opacity="0",this.container.style.transform="translateY(-10px)"})}),setTimeout(()=>{this.createAndShowLoading()},300)):this.createAndShowLoading()}createAndShowLoading(){let t=document.getElementById(this.loadingId);const i=t&&this.container&&this.container.contains(t);t||(t=document.createElement("div"),t.className="loading",t.id=this.loadingId,t.innerHTML=`
        <div class="loading-squares">
          <div class="loading-square"></div>
          <div class="loading-square"></div>
          <div class="loading-square"></div>
        </div>
      `),this.container&&(i||(this.container.innerHTML="",this.container.appendChild(t)),this.container.style.display="",this.container.style.pointerEvents="",this.container.style.opacity="0",this.container.style.transform="",this.container.style.visibility="visible"),t.classList.remove("hidden"),t.style.display="",t.style.opacity="0",t.style.transform="translateY(10px)",requestAnimationFrame(()=>{requestAnimationFrame(()=>{t.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",t.style.opacity="1",t.style.transform="translateY(0)",this.container&&(this.container.style.transition="opacity 0.3s ease-in-out, transform 0.3s ease-in-out",this.container.style.opacity="1",this.container.style.transform="translateY(0)",setTimeout(()=>{this.container.style.opacity="",this.container.style.transform="",this.container.style.transition=""},300))})}),this.loadingElement=t}}class a{constructor(){this.observer=null,this.observedElements=new WeakSet}initObserver(){this.observer||(this.observer=new IntersectionObserver(t=>{t.forEach(i=>{if(i.isIntersecting){const n=i.target.dataset.bgImage;if(n){const e=new Image;e.loading="lazy",e.decoding="async",e.onload=()=>{requestAnimationFrame(()=>{i.target.style.backgroundImage=`url(${n})`,i.target.style.backgroundSize="cover",i.target.style.backgroundPosition="center",i.target.style.opacity="1"})},e.onerror=()=>{console.warn(`Failed to load background image: ${n}`)},e.src=n,delete i.target.dataset.bgImage}this.observer.unobserve(i.target)}})},{rootMargin:"150px",threshold:.01}))}loadBackgroundImage(t,i,n=!1){if(!(!t||!i)){if(n){const e=new Image;e.loading="eager",e.fetchPriority="high",e.decoding="async",e.onload=()=>{requestAnimationFrame(()=>{t.style.backgroundImage=`url(${i})`,t.style.backgroundSize="cover",t.style.backgroundPosition="center",t.style.opacity="1"})},e.onerror=()=>{console.warn(`Failed to load background image: ${i}`)},e.src=i;return}this.initObserver(),t.dataset.bgImage=i,this.observedElements.has(t)||(this.observer.observe(t),this.observedElements.add(t))}}unobserve(t){this.observer&&t&&(this.observer.unobserve(t),this.observedElements.delete(t))}disconnect(){this.observer&&(this.observer.disconnect(),this.observer=null),this.observedElements=new WeakSet}}const r=new a;export{o as L,r as b};
