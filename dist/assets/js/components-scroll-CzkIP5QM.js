class d{constructor(t="scroll-to-top"){this.buttonId=t,this.scrollToTopButton=null,this.footer=null,this.pageWrapper=null,this.lastScrollTop=0,this.hideTimeout=null,this.isAnimating=!1,this.wasShown=!1,this.wasScrollingDown=!1,this.initAttempts=0,this.MAX_INIT_ATTEMPTS=10,this.previousIsTabletMode=!1,this.scrollManager=null,this.positionUpdateRafId=null}init(){if(this.scrollToTopButton=document.getElementById(this.buttonId),!this.scrollToTopButton){this.initAttempts++,this.initAttempts<this.MAX_INIT_ATTEMPTS&&setTimeout(()=>{this.init()},100);return}this.initAttempts=0,this.footer=document.querySelector(".footer"),this.pageWrapper=document.querySelector(".page-wrapper"),this.setupEventListeners();const t=this.getScrollTop();this.lastScrollTop=t<=0?0:Math.round(t),this.handleScroll(),this.updateButtonPosition()}isTabletMode(){return window.innerWidth<1024||window.innerHeight<900}isMobileBrowser(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}isScrollPage(){return document.body.classList.contains("page-with-scroll")}getScrollElement(){return this.isTabletMode()||this.isScrollPage()?window:this.pageWrapper||window}getScrollTop(){const t=this.getScrollElement();if(t===window){if(window.pageYOffset!==void 0)return window.pageYOffset;if(window.scrollY!==void 0)return window.scrollY;const e=document.scrollingElement||document.documentElement;return e&&e.scrollTop!==void 0?e.scrollTop:document.documentElement&&document.documentElement.scrollTop!==void 0?document.documentElement.scrollTop:document.body&&document.body.scrollTop!==void 0?document.body.scrollTop:0}else return t.scrollTop||0}setScrollManager(t){this.scrollManager=t}updateButtonPositionDirect(t){!this.scrollToTopButton||!this.footer||this.isTabletMode()}updateButtonPosition(){if(!this.scrollToTopButton)return;if(!this.footer){this.scrollToTopButton.classList.remove("footer-hidden"),this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.opacity="";return}if(this.isTabletMode()){this.scrollToTopButton.classList.remove("footer-hidden"),this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.transition="",this.scrollToTopButton.style.opacity="";return}const t=this.footer.classList.contains("hidden"),e=this.scrollToTopButton.classList.contains("footer-hidden");if(t===e){this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.opacity="";return}requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(!this.scrollToTopButton||!this.footer)return;this.footer.classList.contains("hidden")?this.scrollToTopButton.classList.add("footer-hidden"):this.scrollToTopButton.classList.remove("footer-hidden"),this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.opacity=""})})}schedulePositionUpdate(){this.positionUpdateRafId!==null&&cancelAnimationFrame(this.positionUpdateRafId),this.positionUpdateRafId=requestAnimationFrame(()=>{this.positionUpdateRafId=null,this.updateButtonPosition()})}isButtonHidden(){return!this.scrollToTopButton||this.scrollToTopButton.style.display==="none"||window.getComputedStyle(this.scrollToTopButton).display==="none"?!0:!this.scrollToTopButton.classList.contains("visible")}isButtonVisible(){return this.scrollToTopButton?this.scrollToTopButton.classList.contains("visible")&&this.scrollToTopButton.style.display!=="none":!1}showButton(){if(!this.scrollToTopButton)return;if(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null,this.isAnimating=!1),this.isButtonVisible()&&!this.isAnimating){this.updateButtonPosition();return}const t=this.isButtonHidden(),e=!this.wasShown||t,i=this.isTabletMode()||this.isMobileBrowser();t&&(i?this.scrollToTopButton.style.setProperty("display","flex","important"):this.scrollToTopButton.style.display="flex"),e?(this.isAnimating=!0,this.scrollToTopButton.classList.remove("visible"),this.updateButtonPosition(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.scrollToTopButton&&(this.scrollToTopButton.classList.add("visible"),this.wasShown=!0,this.updateButtonPosition(),setTimeout(()=>{this.isAnimating=!1},300))})})):(this.scrollToTopButton.classList.add("visible"),this.wasShown=!0,this.updateButtonPosition())}hideButton(){this.scrollToTopButton&&(this.isButtonHidden()||(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null),this.isButtonVisible()&&(this.isAnimating=!0,this.scrollToTopButton.classList.remove("visible"),this.hideTimeout=setTimeout(()=>{this.scrollToTopButton&&(this.scrollToTopButton.classList.contains("visible")||(this.isTabletMode()||this.isMobileBrowser()?this.scrollToTopButton.style.removeProperty("display"):this.scrollToTopButton.style.display="none",this.wasShown=!1),this.isAnimating=!1,this.hideTimeout=null)},300))))}handleScroll(){if(!this.scrollToTopButton)return;const t=this.getScrollTop(),e=this.isTabletMode(),i=e?1:.5,o=t-this.lastScrollTop,s=o<=-i,r=o>=i,l=10,n=t<l;if(this.lastScrollTop=t<=0?0:Math.round(t),n){this.wasScrollingDown=!1,this.hideButton(),this.updateButtonPosition();return}t>=l?s||e&&o<0?(this.isButtonVisible()||this.showButton(),this.wasScrollingDown=!1):(r||e&&o>0)&&(this.wasScrollingDown=!0,this.hideButton()):this.isButtonVisible()&&this.hideButton(),!this.isTabletMode()&&this.footer&&this.schedulePositionUpdate()}setupEventListeners(){this.scrollToTopButton.addEventListener("click",()=>{const t=this.getScrollElement();t===window?window.scrollTo({top:0,behavior:"smooth"}):t.scrollTo({top:0,behavior:"smooth"})}),this.footer&&(this.footerObserver=new MutationObserver(t=>{t.some(i=>i.type==="attributes"&&i.attributeName==="class")&&this.updateButtonPosition()}),this.footerObserver.observe(this.footer,{attributes:!0,attributeFilter:["class"],subtree:!1})),this.setupScrollListener(),this.previousIsTabletMode=this.isTabletMode(),window.addEventListener("resize",()=>{const t=this.isTabletMode();t!==this.previousIsTabletMode&&(this.updateScrollListener(),this.previousIsTabletMode=t),this.handleScroll(),this.updateButtonPosition()})}setupScrollListener(){this.handleScrollBound&&(window.removeEventListener("scroll",this.handleScrollBound),this.pageWrapper&&this.pageWrapper.removeEventListener("scroll",this.handleScrollBound));const t=this.getScrollElement();this.handleScrollBound=this.handleScroll.bind(this),t.addEventListener("scroll",this.handleScrollBound,{passive:!0})}updateScrollListener(){this.handleScrollBound&&(window.removeEventListener("scroll",this.handleScrollBound),this.pageWrapper&&this.pageWrapper.removeEventListener("scroll",this.handleScrollBound));const t=this.getScrollTop();this.lastScrollTop=t<=0?0:Math.round(t),this.setupScrollListener(),this.handleScroll()}}class u{constructor(t,e){this.scrollContainerSelector=t,this.isTabletModeCallback=e,this.scrollContainer=null,this.header=null,this.footer=null,this.decorativeLines=null,this.spacerElement=null,this.isTabletMode=!1,this.lastScrollTop=0,this.isInitialized=!1,this.ticking=!1,this.isScrolling=!1,this.scrollTimeout=null,this.headerFooterHeight=0,this.currentTranslateY=0,this.scrollToTopButton=null}init(){this.scrollContainer=document.querySelector(this.scrollContainerSelector),this.scrollContainer&&(this.header=document.querySelector(".header"),this.footer=document.querySelector(".footer"),this.decorativeLines=document.querySelectorAll(".decorative-line-horizontal"),!(!this.header||!this.footer||this.decorativeLines.length===0)&&(this.isScrollPage=document.body.classList.contains("page-with-scroll"),this.updateHeaderFooterHeight(),this.checkViewportForScroll(),window.addEventListener("resize",()=>{this.updateHeaderFooterHeight(),this.updateSpacerElement(),this.checkViewportForScroll()})))}updateHeaderFooterHeight(){this.headerFooterHeight=this.getHeaderFooterHeight()}getScrollElement(){return this.isTabletMode||this.isScrollPage?window:this.scrollContainer}getHeaderFooterHeight(){if(!this.header||!this.footer)return 0;const t=document.documentElement,e=getComputedStyle(t).getPropertyValue("--header-footer-height");if(e){const s=parseFloat(e);if(!isNaN(s))return s}const i=this.header.offsetHeight||0,o=this.footer.offsetHeight||0;return Math.max(i,o)}createSpacerElement(){let t=document.querySelector(".page-wrapper");t||(t=this.scrollContainer),t||(t=document.querySelector(".content-wrapper")),t&&(this.spacerElement&&this.spacerElement.remove(),this.spacerElement=document.createElement("div"),this.spacerElement.className="scroll-spacer-footer",this.spacerElement.style.cssText=`
      width: 100%;
      height: 0;
      pointer-events: none;
      visibility: hidden;
      flex-shrink: 0;
      box-sizing: border-box;
    `,t.appendChild(this.spacerElement),this.updateSpacerElement())}updateSpacerElement(){if(!this.spacerElement)return;const t=this.getHeaderFooterHeight(),e=20;this.spacerElement.style.height=`${t+e}px`}handleScroll(){this.isScrolling=!0,this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.onScrollEnd()},150),this.ticking||(window.requestAnimationFrame(()=>{this.updateHeaderFooterVisibility(),this.ticking=!1}),this.ticking=!0)}onScrollEnd(){if(this.isScrolling=!1,this.isTabletMode||!this.isScrollPage)return;const t=this.getScrollElement();let e,i,o;t===window?(e=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight,o=window.innerHeight):(e=t.scrollTop,i=t.scrollHeight,o=t.clientHeight);const s=e<=10,r=e+o>=i-10;if(s||r){this.animateToFullyVisible();return}Math.abs(this.currentTranslateY)>this.headerFooterHeight/2?this.animateToFullyHidden():this.animateToFullyVisible()}animateToFullyVisible(){this.currentTranslateY=0,this.showHeaderFooter()}animateToFullyHidden(){this.currentTranslateY=-this.headerFooterHeight,this.hideHeaderFooter()}updateHeaderFooterVisibility(){if(this.isTabletMode)return;const t=this.getScrollElement();let e,i,o;if(t===window?(e=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight,o=window.innerHeight):(e=t.scrollTop,i=t.scrollHeight,o=t.clientHeight),!this.isScrollPage)return;const s=e<=10,r=e+o>=i-10,l=e-this.lastScrollTop,h=l>0,n=l<0,a=.5;s||r?this.showHeaderFooter():h&&Math.abs(l)>a?this.hideHeaderFooter():n&&Math.abs(l)>a&&this.showHeaderFooter(),this.lastScrollTop=e<=0?0:e}setScrollToTopButton(t){this.scrollToTopButton=t}showHeaderFooter(){this.header.classList.remove("hidden"),this.footer.classList.remove("hidden"),this.decorativeLines.forEach(t=>t.classList.remove("hidden")),this.currentTranslateY=0}hideHeaderFooter(){this.header.classList.add("hidden"),this.footer.classList.add("hidden"),this.decorativeLines.forEach(t=>t.classList.add("hidden")),this.currentTranslateY=-this.headerFooterHeight}checkViewportForScroll(){document.querySelector(".slides-container"),this.isScrollPage=document.body.classList.contains("page-with-scroll"),!this.isInitialized&&this.isScrollPage&&window.innerWidth>=1024&&window.innerHeight>=900&&this.createSpacerElement();const t=window.innerWidth<1024||window.innerHeight<900,e=this.isTabletMode;if(t===this.isTabletMode&&this.isScrollPage&&this.isInitialized)return;this.isTabletMode=t,e!==this.isTabletMode&&(this.isTabletMode?(this.showHeaderFooter(),this.currentTranslateY=0):this.currentTranslateY=0),!this.isTabletMode&&this.isScrollPage?this.spacerElement?this.updateSpacerElement():this.createSpacerElement():this.spacerElement&&(this.spacerElement.remove(),this.spacerElement=null),this.isTabletModeCallback&&this.isTabletModeCallback(this.isTabletMode),(e||this.isScrollPage&&!e)&&window.removeEventListener("scroll",this.handleScrollBound),!e&&!this.isScrollPage&&this.scrollContainer.removeEventListener("scroll",this.handleScrollBound);const i=this.getScrollElement();i===window?this.lastScrollTop=window.pageYOffset||document.documentElement.scrollTop:this.lastScrollTop=i.scrollTop,this.handleScrollBound=this.handleScroll.bind(this),this.isTabletMode||this.isScrollPage?(window.addEventListener("scroll",this.handleScrollBound,{passive:!0}),this.isTabletMode||this.updateHeaderFooterVisibility()):this.showHeaderFooter(),this.isInitialized=!0}getFooterOffset(){return this.isTabletMode?0:this.footer&&this.footer.classList.contains("hidden")?this.headerFooterHeight:0}}export{u as S,d as a};
