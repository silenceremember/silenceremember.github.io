import{a as x,b as w,l as j,c as k,A as C,d as F}from"./utils-DDkmD0RB.js";import{L as H}from"./layout-C0B9eYKg.js";const Y="modulepreload",O=function(E){return"/"+E},M={},L=function(t,e,s){let n=Promise.resolve();if(e&&e.length>0){let a=function(l){return Promise.all(l.map(c=>Promise.resolve(c).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),o=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));n=a(e.map(l=>{if(l=O(l),l in M)return;M[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":Y,c||(u.as="script"),u.crossOrigin="",u.href=l,o&&u.setAttribute("nonce",o),document.head.appendChild(u),c)return new Promise((p,f)=>{u.addEventListener("load",p),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(r){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r}return n.then(r=>{for(const o of r||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})};class R{constructor(t){if(!t)throw new Error("slidesContainer is required");this.slidesContainer=t,this.lastKnownMode=null,this.animationTimeout=null,this.isAnimating=!1,this.debounceTimeout=null,this.lastActiveSlideIndex=null,this.slideAnimationTimeout=null,this.isModeSwitching=!1,this.slideObserver=null,this.containerObserver=null}initializeFirstSlideAnimation(){if(!this.slidesContainer){this.setupSlideAnimations();return}const t=this.slidesContainer.classList.contains("tablet-scroll-mode"),e=this.slidesContainer.querySelectorAll(".slide");e.forEach(s=>{this.hideSlideElementsBeforeAnimation(s)}),e.length>0&&e[0].firstElementChild&&e[0].firstElementChild.offsetHeight,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.forEach(s=>{const n=parseInt(s.getAttribute("data-slide"));let i=[];n===0?i=s.querySelectorAll(".main-content-name, .main-content-tagline, .main-content-title, .cv-about-text, .portrait-image"):n===4?i=s.querySelectorAll(".section-title, .cta-button, .cta-divider"):i=s.querySelectorAll(".section-title, .project-title, .project-meta, .project-placeholder, .details-block, .preview-placeholder"),i.forEach(r=>{if(r){const o=window.getComputedStyle(r);parseFloat(o.opacity)>.01&&(r.style.setProperty("opacity","0","important"),r.style.setProperty("transform","translateY(10px)","important"),r.style.setProperty("transition","none","important"))}})}),setTimeout(()=>{t?this.lastKnownMode===null&&(this.lastKnownMode=t,this.restartAnimationsOnModeChange()):(this.lastKnownMode===null&&(this.lastKnownMode=t),this.lastActiveSlideIndex===null&&(this.lastActiveSlideIndex=0,this.animateFirstSlide())),this.setupSlideAnimations()},100)})})}animateFirstSlide(){const t=this.slidesContainer.querySelector('.slide[data-slide="0"]');t&&this.animateSlideContent(t)}restartAnimationsOnModeChange(){if(!this.slidesContainer)return;const t=this.slidesContainer.classList.contains("tablet-scroll-mode");this.isAnimating&&this.animationTimeout&&(clearTimeout(this.animationTimeout),this.animationTimeout=null),this.isAnimating=!0;const e=this.slidesContainer.querySelectorAll(".slide");this.animationTimeout=setTimeout(()=>{if(t){const s=[];e.forEach(i=>{const r=window.getComputedStyle(i);if(r.opacity!=="0"&&r.visibility!=="hidden"){const o=parseInt(i.getAttribute("data-slide"));if(o===0){const a=i.querySelectorAll(".main-content-name, .main-content-tagline, .main-content-title, .cv-about-text"),l=i.querySelector(".portrait-image");s.push(...Array.from(a)),l&&s.push(l)}else if(o===4){const a=i.querySelector(".section-title"),l=i.querySelectorAll(".cta-button"),c=i.querySelector(".cta-divider");a&&s.push(a),s.push(...Array.from(l)),c&&s.push(c)}else{const a=i.querySelectorAll(".section-title, .project-title, .project-meta, .project-placeholder, .details-block, .preview-placeholder");s.push(...Array.from(a))}}});const n=s.filter(i=>{if(!i)return!1;const r=window.getComputedStyle(i),o=parseFloat(r.opacity),a=i.style.opacity,l=i.style.transform;return!(o>=.99&&(!a||a===""||a==="1")&&(!l||l===""||l.includes("translateY(0")))});n.length>0&&(n.forEach(i=>{i.style.setProperty("opacity","0","important"),i.style.setProperty("transform","translateY(10px)","important"),i.style.setProperty("transition","none","important")}),n.length>0&&n[0]&&n[0].offsetHeight),n.length>0?requestAnimationFrame(()=>{requestAnimationFrame(()=>{x(n,{skipInitialState:!0})})}):(this.isAnimating=!1,this.animationTimeout=null)}else{const s=this.slidesContainer.querySelector(".slide.active");s&&(this.hideSlideElementsBeforeAnimation(s),s.firstElementChild&&s.firstElementChild.offsetHeight,requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.animateSlideContent(s)})}))}setTimeout(()=>{this.isAnimating=!1,this.animationTimeout=null},500)},50)}setupSlideAnimations(){if(!this.slidesContainer)return;this.slideObserver=new MutationObserver(e=>{e.forEach(s=>{if(s.type==="attributes"&&s.attributeName==="class"){const n=s.target;if(n.classList.contains("active")&&n.classList.contains("slide")){const i=parseInt(n.getAttribute("data-slide"));if(this.lastActiveSlideIndex===i&&this.lastActiveSlideIndex!==null)return;if(this.isModeSwitching){this.lastActiveSlideIndex=i,this.showActiveSlideElements();return}this.slideAnimationTimeout&&(clearTimeout(this.slideAnimationTimeout),this.slideAnimationTimeout=null),this.lastActiveSlideIndex=i,this.slideAnimationTimeout=setTimeout(()=>{this.animateSlideContent(n),this.slideAnimationTimeout=null},100)}}})}),this.slidesContainer.querySelectorAll(".slide").forEach(e=>{this.slideObserver.observe(e,{attributes:!0,attributeFilter:["class"]})}),this.containerObserver=new MutationObserver(e=>{e.forEach(s=>{if(s.type==="attributes"&&s.attributeName==="class"&&s.target===this.slidesContainer){const i=this.slidesContainer.classList.contains("tablet-scroll-mode"),r=this.lastKnownMode!==i;if(r&&i===!1&&this.lastKnownMode===!0){this.isModeSwitching=!0,this.slideAnimationTimeout&&(clearTimeout(this.slideAnimationTimeout),this.slideAnimationTimeout=null),this.lastKnownMode=i,this.showActiveSlideElements(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.showActiveSlideElements(),setTimeout(()=>{this.isModeSwitching=!1},500)})});return}if(r&&i===!0){this.isModeSwitching=!0,this.lastKnownMode=i,requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.showAllSlideElements(),setTimeout(()=>{this.isModeSwitching=!1},200)})});return}r&&(this.lastKnownMode=i)}})}),this.containerObserver.observe(this.slidesContainer,{attributes:!0,attributeFilter:["class"]}),this.lastKnownMode=this.slidesContainer.classList.contains("tablet-scroll-mode")}showAllSlideElements(){this.slidesContainer.querySelectorAll(".slide").forEach(e=>{const s=parseInt(e.getAttribute("data-slide"));let n=[];s===0?n=e.querySelectorAll(".main-content-name, .main-content-tagline, .main-content-title, .cv-about-text, .portrait-image"):s===4?n=e.querySelectorAll(".section-title, .cta-button, .cta-divider"):n=e.querySelectorAll(".section-title, .project-title, .project-meta, .project-placeholder, .details-block, .preview-placeholder"),n.forEach(i=>{i&&(i.style.removeProperty("opacity"),i.style.removeProperty("transform"),i.style.removeProperty("transition"))})})}showActiveSlideElements(){const t=this.slidesContainer.querySelector(".slide.active");if(!t)return;const e=parseInt(t.getAttribute("data-slide"));let s=[];e===0?s=t.querySelectorAll(".main-content-name, .main-content-tagline, .main-content-title, .cv-about-text, .portrait-image"):e===4?s=t.querySelectorAll(".section-title, .cta-button, .cta-divider"):s=t.querySelectorAll(".section-title, .project-title, .project-meta, .project-placeholder, .details-block, .preview-placeholder"),s.forEach(n=>{n&&(n.style.removeProperty("opacity"),n.style.removeProperty("transform"),n.style.removeProperty("transition"))})}hideSlideElementsBeforeAnimation(t){const e=parseInt(t.getAttribute("data-slide"));if(e===0){t.querySelectorAll(".main-content-name, .main-content-tagline, .main-content-title, .cv-about-text, .portrait-image").forEach(i=>{i&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform","translateY(10px)","important"),i.style.setProperty("transition","none","important"))});return}if(e===4){t.querySelectorAll(".section-title, .cta-button, .cta-divider").forEach(i=>{i&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform","translateY(10px)","important"),i.style.setProperty("transition","none","important"))});return}t.querySelectorAll(".section-title, .project-title, .project-meta, .project-placeholder, .details-block, .preview-placeholder").forEach(n=>{n&&(n.style.setProperty("opacity","0","important"),n.style.setProperty("transform","translateY(10px)","important"),n.style.setProperty("transition","none","important"))})}animateSlideContent(t){if(this.isModeSwitching)return;const e=parseInt(t.getAttribute("data-slide"));this.hideSlideElementsBeforeAnimation(t),t.firstElementChild&&t.firstElementChild.offsetHeight,requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(()=>{if(e===0){const i=[".main-content-name",".main-content-tagline",".main-content-title",".cv-about-text"];i.forEach((o,a)=>{const l=t.querySelector(o);l&&setTimeout(()=>{w(l,{skipInitialState:!0})},a*30)});const r=t.querySelector(".portrait-image");r&&setTimeout(()=>{w(r,{skipInitialState:!0})},i.length*30);return}if(e===4){const i=t.querySelector(".section-title"),r=t.querySelectorAll(".cta-button"),o=t.querySelector(".cta-divider");i&&w(i,{skipInitialState:!0}),r.length>0&&setTimeout(()=>{r.forEach((a,l)=>{setTimeout(()=>{w(a,{skipInitialState:!0})},l*30)})},50),o&&setTimeout(()=>{w(o,{skipInitialState:!0})},100+r.length*30);return}const s=[".section-title",".project-title",".project-meta",".project-placeholder",".details-block"];s.forEach((i,r)=>{const o=t.querySelectorAll(i);o.length>0&&setTimeout(()=>{o.forEach(a=>{w(a,{skipInitialState:!0})})},r*30)});const n=t.querySelectorAll(".preview-placeholder");n.length>0&&setTimeout(()=>{n.forEach(i=>{w(i,{skipInitialState:!0})})},s.length*30)},50)})})}hideAllSlideElementsImmediately(){if(!this.slidesContainer)return;this.slidesContainer.querySelectorAll(".slide").forEach(e=>{const s=parseInt(e.getAttribute("data-slide"));let n=[];s===0?n=e.querySelectorAll(".main-content-name, .main-content-tagline, .main-content-title, .cv-about-text, .portrait-image"):s===4?n=e.querySelectorAll(".section-title, .cta-button, .cta-divider"):n=e.querySelectorAll(".section-title, .project-title, .project-meta, .project-placeholder, .details-block, .preview-placeholder"),n.forEach(i=>{i&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform","translateY(10px)","important"),i.style.setProperty("transition","none","important"))})})}}const D=new H,$=E=>D.loadHTML(E);class V{constructor(t,e,s={}){this.projects=t,this.allProjectCards=e,this.onCardClick=s.onCardClick||(()=>{}),this.onRenderGrouped=s.onRenderGrouped||(async()=>{}),this.onHideLoading=s.onHideLoading||(async()=>{}),this.onExpandedSectionsClear=s.onExpandedSectionsClear||(()=>{}),this.activeFilters={category:[],status:[],year:[]},this.savedYearButtonWidth=null,this.projectFiltersTemplate=null,this.isApplyingFilters=!1}async init(t){t&&(this.projects=t);const e=document.getElementById("projects-filters-container");if(!e)return;if(!this.projectFiltersTemplate)try{this.projectFiltersTemplate=await $("/components/project-filters.html")}catch(i){console.error("Ошибка загрузки шаблона фильтров:",i);return}const s=e.querySelector("#project-filters-year-button");s&&s.style.width&&(this.savedYearButtonWidth=s.style.width),[...new Set(this.projects.map(i=>i.category))],[...new Set(this.projects.map(i=>i.status))];const n=[...new Set(this.projects.map(i=>i.year).filter(Boolean).sort((i,r)=>r-i))];if(this.projectFiltersTemplate){e.innerHTML=this.projectFiltersTemplate;const i=e.querySelector(".project-filters-content");i&&(i.style.opacity="0",i.style.transform="translateY(10px)",i.style.transition="none",i.offsetHeight);const r={};this.projects.forEach(c=>{c.year&&(r[c.year]=(r[c.year]||0)+1)});const o=e.querySelector("#project-filters-year-dropdown-menu"),a=e.querySelector("#project-filters-year-button");let l=!1;if(o){const c=document.createElement("button");if(c.className="project-filters-year-option project-filters-year-option-dash",c.type="button",c.setAttribute("data-value",""),c.innerHTML=`
          <span class="project-filters-year-option-label">—</span>
          <span class="project-filters-year-option-count" style="display: none;"></span>
        `,o.appendChild(c),n.forEach(d=>{const u=document.createElement("button");u.className="project-filters-year-option",u.type="button",u.setAttribute("data-value",d.toString()),u.innerHTML=`
            <span class="project-filters-year-option-label">${d}</span>
            <span class="project-filters-year-option-count">${r[d]||0}</span>
          `,o.appendChild(u)}),a){let d=!0;if(this.savedYearButtonWidth&&parseFloat(this.savedYearButtonWidth)>0&&(a.style.width=this.savedYearButtonWidth,a.style.minWidth=this.savedYearButtonWidth,a.style.maxWidth=this.savedYearButtonWidth,o.style.width=this.savedYearButtonWidth,(window.innerWidth<1024||window.innerHeight<900)&&(o.style.setProperty("width",this.savedYearButtonWidth,"important"),o.style.setProperty("min-width","0","important")),d=!1),d){const u=()=>new Promise(f=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{const v=a.style.width,q=o.style.width;a.style.width="",o.style.width="";const m=document.createElement("div");m.style.position="absolute",m.style.visibility="hidden",m.style.top="-9999px",m.style.left="-9999px",m.style.display="flex",m.style.flexDirection="column",m.style.width="auto",m.style.height="auto",m.style.overflow="visible",document.body.appendChild(m);const h=o.cloneNode(!0);h.hidden=!1,h.style.display="flex",h.style.flexDirection="column",h.style.visibility="visible",h.style.position="static",h.style.width="auto",h.style.minWidth="auto",h.style.maxWidth="none",h.style.maxHeight="none",h.style.overflow="visible",m.appendChild(h);const g=h.querySelectorAll(".project-filters-year-option");let b=0;if(g.length===0){document.body.removeChild(m),a.style.width=v,o.style.width=q,f(0);return}g.forEach(A=>{const y=A.style.width,S=A.style.display;A.style.width="auto",A.style.display="flex";const T=A.getBoundingClientRect().width;A.style.width=y,A.style.display=S,T>b&&(b=T)}),document.body.removeChild(m),a.style.width=v,o.style.width=q,f(b)})})}),p=f=>{f>0&&(a.style.width=`${f}px`,a.style.minWidth=`${f}px`,a.style.maxWidth=`${f}px`,o.style.width=`${f}px`,(window.innerWidth<1024||window.innerHeight<900)&&(o.style.setProperty("width",`${f}px`,"important"),o.style.setProperty("min-width","0","important")),this.savedYearButtonWidth=`${f}px`)};requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(()=>{u().then(f=>{p(f),i&&!l&&(l=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{w(i)})}))})},50)})})}else i&&!l&&(l=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{w(i)})}))}else i&&!l&&(l=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{w(i)})}))}else i&&!l&&(l=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{w(i)})}))}this.updateFilterCounts(this.projects),this.initFilterButtons(),this.initYearDropdown()}updateFilterCounts(t){const e={},s={};t.forEach(n=>{e[n.category]=(e[n.category]||0)+1,s[n.status]=(s[n.status]||0)+1}),document.querySelectorAll(".project-filters-option").forEach(n=>{const i=n.getAttribute("data-value"),r=n.querySelector(".project-filters-option-count");if(!r)return;const o=n.closest("[data-filter]");if(!o)return;const a=o.getAttribute("data-filter");let l=0;a==="category"?l=e[i]||0:a==="status"&&(l=s[i]||0),r.textContent=l})}initFilterButtons(){document.querySelectorAll(".project-filters-option").forEach(s=>{s.addEventListener("click",()=>{const n=s.closest("[data-filter]");if(!n)return;const i=n.getAttribute("data-filter"),r=s.getAttribute("data-value");i&&r&&this.toggleFilter(i,r,s)})});const e=document.getElementById("project-filters-reset");e&&e.addEventListener("click",()=>{this.clearAllFilters()})}initYearDropdown(){const t=document.getElementById("project-filters-year-button"),e=document.getElementById("project-filters-year-dropdown-menu");if(!t||!e){console.warn("Dropdown элементы не найдены");return}t.addEventListener("click",i=>{i.stopPropagation();const o=!(t.getAttribute("aria-expanded")==="true");t.setAttribute("aria-expanded",o),o?(e.hidden=!1,e.style.top="",e.style.left="",e.style.opacity="0",requestAnimationFrame(()=>{e.style.transition="opacity 0.15s ease-in-out",e.style.opacity="1"})):(e.style.transition="opacity 0.15s ease-in-out",e.style.opacity="0",setTimeout(()=>{e.hidden=!0,e.style.opacity="",e.style.transition=""},150))});const s=i=>{!t.contains(i.target)&&!e.contains(i.target)&&(t.setAttribute("aria-expanded","false"),e.style.transition="opacity 0.15s ease-in-out",e.style.opacity="0",setTimeout(()=>{e.hidden=!0,e.style.opacity="",e.style.transition=""},150))};document.addEventListener("click",s,!0);const n=i=>{const r=i.getAttribute("data-value"),o=i.querySelector(".project-filters-year-option-label"),a=i.querySelector(".project-filters-year-option-count"),l=o?o.textContent.trim():r,c=a&&a.style.display!=="none"?a.textContent.trim():"0",d=t.querySelector(".project-filters-year-button-label"),u=t.querySelector(".project-filters-year-button-count");t.setAttribute("aria-expanded","false"),e.style.transition="opacity 0.15s ease-in-out",e.style.opacity="0",setTimeout(()=>{e.hidden=!0,e.style.opacity="",e.style.transition=""},150),!r||r===""||this.activeFilters.year.length>0&&this.activeFilters.year[0]===r?(this.activeFilters.year=[],d&&(d.textContent="—"),u&&(u.textContent="0",u.style.display="none"),t.classList.remove("has-count")):(this.activeFilters.year=[r],d&&(d.textContent=l),u&&(u.textContent=c,u.style.display="flex"),t.classList.add("has-count")),this.applyFilters()};e.addEventListener("click",i=>{const r=i.target.closest(".project-filters-year-option");r&&(i.stopPropagation(),n(r))})}toggleFilter(t,e,s){this.activeFilters[t]||(this.activeFilters[t]=[]);const n=this.activeFilters[t].indexOf(e);n!==-1?(this.activeFilters[t].splice(n,1),s.setAttribute("aria-pressed","false"),s.classList.remove("active")):(this.activeFilters[t].push(e),s.setAttribute("aria-pressed","true"),s.classList.add("active")),this.applyFilters()}clearAllFilters(){this.activeFilters={category:[],status:[],year:[]},document.querySelectorAll(".project-filters-option").forEach(s=>{s.setAttribute("aria-pressed","false"),s.classList.remove("active")});const t=document.getElementById("project-filters-year-button"),e=document.getElementById("project-filters-year-dropdown-menu");if(t){const s=t.querySelector(".project-filters-year-button-label"),n=t.querySelector(".project-filters-year-button-count");s&&(s.textContent="—"),n&&(n.textContent="0",n.style.display="none"),t.classList.remove("has-count"),t.setAttribute("aria-expanded","false")}e&&(e.style.transition="opacity 0.15s ease-in-out",e.style.opacity="0",setTimeout(()=>{e.hidden=!0,e.style.opacity="",e.style.transition=""},150)),this.applyFilters()}async applyFilters(){const t=document.getElementById("projects-grid");if(t&&!this.isApplyingFilters){this.isApplyingFilters=!0;try{if(!Object.values(this.activeFilters).some(p=>p.length>0)){this.onExpandedSectionsClear();const p=document.getElementById("projects-loading");if(p){const f=window.getComputedStyle(p);f.display!=="none"&&f.visibility!=="hidden"&&parseFloat(f.opacity)>.01&&await this.onHideLoading()}await this.onRenderGrouped();return}document.getElementById("projects-loading")&&await this.onHideLoading(),t.innerHTML="",t.className="projects-grid";const n=document.createElement("div");n.className="projects-section";const i=document.createElement("div");i.className="projects-section-header";const r=document.createElement("h2");r.className="projects-section-title",r.id="project-filters-results";const o=document.createElement("span");o.className="projects-section-title-text",o.textContent=j.t("projects.filters.found"),r.appendChild(o);const a=document.createElement("span");a.className="project-filters-option-count",a.textContent="0",r.appendChild(a);const l=document.createElement("button");l.className="projects-section-expand",l.id="project-filters-reset",l.setAttribute("aria-label",j.t("projects.filters.resetAria"));const c=document.createElement("span");c.className="projects-section-expand-text",c.textContent=j.t("projects.filters.reset"),l.appendChild(c),l.addEventListener("click",()=>{this.clearAllFilters()}),r.appendChild(l),i.appendChild(r),n.appendChild(i);const d=document.createElement("div");d.className="projects-section-grid";let u=0;this.projects.forEach(p=>{let f=!0;if(f&&this.activeFilters.category.length>0&&(this.activeFilters.category.includes(p.category)||(f=!1)),f&&this.activeFilters.status.length>0&&(this.activeFilters.status.includes(p.status)||(f=!1)),f&&this.activeFilters.year.length>0&&p.year&&!this.activeFilters.year.includes(p.year.toString())&&(f=!1),f){let v=null;const q=this.allProjectCards.get(p.id);if(q){v=q.cloneNode(!0),v.querySelectorAll("[data-svg-loaded]").forEach(h=>{h.removeAttribute("data-svg-loaded")}),v.querySelectorAll(".project-card-star, .project-card-divider").forEach(h=>{if(h.tagName==="svg"&&!h.hasAttribute("data-svg-src")){const g=h.className.baseVal||h.className,b=typeof g=="string",A=b&&g.includes("project-card-star"),y=b&&g.includes("project-card-divider");if(A||y){const S=document.createElement("span");S.className=A?"project-card-star":"project-card-divider",S.setAttribute("data-svg-src",A?"assets/images/icon-star.svg":"assets/images/icon-divider-small.svg"),h.parentNode&&h.parentNode.replaceChild(S,h)}}else h.tagName==="SPAN"&&h.hasAttribute("data-svg-src")&&h.removeAttribute("data-svg-loaded")}),v.style.opacity="0",v.style.transform="translateY(10px)",v.style.transition="none",v.addEventListener("click",h=>{const g=window.getSelection();g&&g.toString().trim().length>0||(h.stopPropagation(),p.comingSoon||this.onCardClick(p))});const m=v.querySelector(".project-card-button");m&&m.addEventListener("click",h=>{h.stopPropagation(),p.comingSoon||this.onCardClick(p)})}if(v){d.appendChild(v);const m=v.querySelector("img[data-src]");m&&k.loadImage(m),u++}}}),a.textContent=u,n.appendChild(d),t.appendChild(n),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const p=d.querySelectorAll(".project-card");p.length>0&&x(p)})}),requestAnimationFrame(async()=>{try{const{globalSvgLoader:p}=await L(async()=>{const{globalSvgLoader:f}=await import("./components-svg-D1ZYaihp.js");return{globalSvgLoader:f}},[]);await p.init()}catch(p){console.error("Ошибка загрузки SVG:",p)}})}finally{this.isApplyingFilters=!1}}}}class G{constructor(t,e,s={}){this.projects=t||[],this.allProjectCards=e||new Map,this.onCardClick=s.onCardClick||(()=>{}),this.onHideLoading=s.onHideLoading||(()=>Promise.resolve()),this.expandedSections=new Set,this.isRendering=!1,this.activeTimeouts=new Map,this.isAnimating=new Map,this.CARD_ANIMATION=C}_stopAllAnimations(t){t.forEach(e=>{if(!e||!e.parentNode)return;e.style.setProperty("transition","none","important");const s=window.getComputedStyle(e),n=s.opacity,i=s.transform;e.style.setProperty("opacity",n,"important"),e.style.setProperty("transform",i,"important"),e.offsetHeight})}toggleSectionExpansion(t,e,s){const n=document.querySelector(`[data-category="${t}"]`);if(!n||this.isAnimating.get(t))return;(this.activeTimeouts.get(t)||[]).forEach(a=>{clearTimeout(a)}),this.activeTimeouts.set(t,[]);const r=this.expandedSections.has(t),o=Array.from(n.querySelectorAll('[data-hidden-card="true"], .project-card-hidden')).filter(a=>a&&a.parentNode);if(this.isAnimating.set(t,!0),r){this._stopAllAnimations(o),o.forEach(c=>{c.style.removeProperty("transition"),c.style.removeProperty("opacity"),c.style.removeProperty("transform"),c.style.transition=`opacity ${this.CARD_ANIMATION.duration} ${this.CARD_ANIMATION.timing}, transform ${this.CARD_ANIMATION.duration} ${this.CARD_ANIMATION.timing}`,c.offsetHeight,c.style.opacity="0",c.style.transform=`translateY(${C.translateYDisappear})`});const a=setTimeout(()=>{if(!this.isAnimating.get(t))return;o.forEach(u=>{!u||!u.parentNode||(u.style.display="none",u.style.removeProperty("opacity"),u.style.removeProperty("transform"),u.style.removeProperty("transition"),u.style.removeProperty("visibility"),u.classList.add("project-card-hidden"),u.setAttribute("data-hidden-card","true"))}),this.isAnimating.set(t,!1);const c=this.activeTimeouts.get(t)||[],d=c.indexOf(a);d>-1&&c.splice(d,1)},this.CARD_ANIMATION.timeout),l=this.activeTimeouts.get(t)||[];l.push(a),this.activeTimeouts.set(t,l),this.expandedSections.delete(t),e.setAttribute("aria-expanded","false"),e.querySelector(".projects-section-expand-text").textContent=j.t("projects.filters.showAll")}else this._stopAllAnimations(o),o.forEach(a=>{a.classList.remove("project-card-hidden"),a.setAttribute("data-hidden-card","true"),a.style.display="",a.style.removeProperty("opacity"),a.style.removeProperty("transform"),a.style.removeProperty("transition"),a.style.removeProperty("visibility"),a.style.opacity="0",a.style.transform=`translateY(${C.translateYAppear})`,a.style.transition="none"}),o.length>0&&o[0]&&o[0].offsetHeight,requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.isAnimating.get(t)&&(o.length>0?(o.forEach(a=>{if(!a||!a.parentNode)return;const l=window.getComputedStyle(a);parseFloat(l.opacity)>.01&&(a.style.opacity="0",a.style.transform=`translateY(${C.translateYAppear})`,a.style.transition="none",a.offsetHeight)}),o.length>0&&o[0]&&o[0].offsetHeight,requestAnimationFrame(()=>{if(!this.isAnimating.get(t))return;o.forEach(c=>{!c||!c.parentNode||(c.style.removeProperty("transition"),c.style.transition=`opacity ${this.CARD_ANIMATION.duration} ${this.CARD_ANIMATION.timing}, transform ${this.CARD_ANIMATION.duration} ${this.CARD_ANIMATION.timing}`)}),o.length>0&&o[0]&&o[0].offsetHeight,o.forEach(c=>{!c||!c.parentNode||(c.style.removeProperty("opacity"),c.style.removeProperty("transform"),c.style.opacity="1",c.style.transform=`translateY(${C.translateYFinal})`)});const a=setTimeout(()=>{if(!this.isAnimating.get(t))return;o.forEach(u=>{!u||!u.parentNode||(u.style.removeProperty("transform"),u.style.removeProperty("opacity"),u.style.removeProperty("transition"))}),this.isAnimating.set(t,!1);const c=this.activeTimeouts.get(t)||[],d=c.indexOf(a);d>-1&&c.splice(d,1)},C.timeout),l=this.activeTimeouts.get(t)||[];l.push(a),this.activeTimeouts.set(t,l)})):this.isAnimating.set(t,!1))})}),this.expandedSections.add(t),e.setAttribute("aria-expanded","true"),e.querySelector(".projects-section-expand-text").textContent=j.t("projects.filters.hide")}createSection(t,e,s){const n=e.filter(m=>m.featured),i=e.filter(m=>!m.featured&&m.tier===2),r=e.filter(m=>!m.featured&&m.tier!==2),o=(m,h)=>{const g=m.year||0;return(h.year||0)-g};n.sort(o),i.sort(o),r.sort(o);const a=[...i,...r],l=n.length>0,c=l?n:e,d=l&&a.length>0,u=document.createElement("div");u.className="projects-section",u.setAttribute("data-category",t),u.style.opacity="0",u.style.transform="translateY(10px)",u.style.transition="none";const p=document.createElement("div");p.className="projects-section-header";const f=document.createElement("h2");f.className="projects-section-title";const v=document.createElement("span");if(v.className="projects-section-title-text",v.textContent=s[t],f.appendChild(v),d){const m=document.createElement("button");m.className="projects-section-expand",m.setAttribute("aria-expanded","false"),m.setAttribute("aria-label",j.t("projects.filters.showAllAria")),m.innerHTML=`
        <span class="projects-section-expand-text">${j.t("projects.filters.showAll")}</span>
        <span class="projects-section-expand-count">${e.length}</span>
      `,m.addEventListener("click",()=>{this.toggleSectionExpansion(t,m,a)}),f.appendChild(m)}p.appendChild(f),u.appendChild(p);const q=document.createElement("div");return q.className="projects-section-grid",c.forEach(m=>{const h=this.allProjectCards.get(m.id);if(h){const g=h.cloneNode(!0);g.querySelectorAll("[data-svg-loaded]").forEach(y=>{y.removeAttribute("data-svg-loaded")}),g.querySelectorAll(".project-card-star, .project-card-divider").forEach(y=>{if(y.tagName==="svg"&&!y.hasAttribute("data-svg-src")){const S=y.className.baseVal||y.className,P=typeof S=="string",T=P&&S.includes("project-card-star"),N=P&&S.includes("project-card-divider");if(T||N){const I=document.createElement("span");I.className=T?"project-card-star":"project-card-divider",I.setAttribute("data-svg-src",T?"assets/images/icon-star.svg":"assets/images/icon-divider-small.svg"),y.parentNode&&y.parentNode.replaceChild(I,y)}}else y.tagName==="SPAN"&&y.hasAttribute("data-svg-src")&&y.removeAttribute("data-svg-loaded")}),g.style.opacity="0",g.style.transform="translateY(10px)",g.style.transition="none",g.addEventListener("click",y=>{y.stopPropagation(),m.comingSoon||this.onCardClick(m)});const b=g.querySelector(".project-card-button");b&&b.addEventListener("click",y=>{y.stopPropagation(),m.comingSoon||this.onCardClick(m)}),q.appendChild(g);const A=g.querySelector("img[data-src]");A&&k.loadImage(A)}}),d&&a.forEach(m=>{const h=this.allProjectCards.get(m.id);if(h){const g=h.cloneNode(!0);g.querySelectorAll("[data-svg-loaded]").forEach(y=>{y.removeAttribute("data-svg-loaded")}),g.querySelectorAll(".project-card-star, .project-card-divider").forEach(y=>{if(y.tagName==="svg"&&!y.hasAttribute("data-svg-src")){const S=y.className.baseVal||y.className,P=typeof S=="string",T=P&&S.includes("project-card-star"),N=P&&S.includes("project-card-divider");if(T||N){const I=document.createElement("span");I.className=T?"project-card-star":"project-card-divider",I.setAttribute("data-svg-src",T?"assets/images/icon-star.svg":"assets/images/icon-divider-small.svg"),y.parentNode&&y.parentNode.replaceChild(I,y)}}else y.tagName==="SPAN"&&y.hasAttribute("data-svg-src")&&y.removeAttribute("data-svg-loaded")}),g.classList.add("project-card-hidden"),g.setAttribute("data-hidden-card","true"),g.style.display="none",g.style.opacity="0",g.style.transition="none",g.addEventListener("click",y=>{const S=window.getSelection();S&&S.toString().trim().length>0||(y.stopPropagation(),m.comingSoon||this.onCardClick(m))});const b=g.querySelector(".project-card-button");b&&b.addEventListener("click",y=>{y.stopPropagation(),m.comingSoon||this.onCardClick(m)}),q.appendChild(g);const A=g.querySelector("img[data-src]");A&&k.loadImage(A)}}),u.appendChild(q),u}async renderGroupedProjects(){if(this.isRendering){console.warn("renderGroupedProjects уже выполняется");return}const t=document.getElementById("projects-grid");if(!t){console.warn("Сетка проектов не найдена");return}if(this.allProjectCards.size===0){console.warn("Карточки проектов еще не созданы");return}this.isRendering=!0,this.activeTimeouts.forEach((s,n)=>{s.forEach(i=>{clearTimeout(i)})}),this.activeTimeouts.clear(),this.isAnimating.clear(),this.expandedSections.clear();const e=document.getElementById("projects-loading");if(e){const s=window.getComputedStyle(e);s.display!=="none"&&s.visibility!=="hidden"&&parseFloat(s.opacity)>.01&&await this.onHideLoading()}try{t.innerHTML="",t.className="projects-grid",(!t.style.opacity||t.style.opacity==="")&&(t.style.opacity="0"),t.style.visibility="visible";const s={games:[],tools:[],research:[]};this.projects.forEach(o=>{s[o.category]&&s[o.category].push(o)});const n={games:j.t("projects.filters.categories.games"),tools:j.t("projects.filters.categories.tools"),research:j.t("projects.filters.categories.research")};Object.keys(s).forEach(o=>{const a=s[o];if(a.length===0)return;const l=this.createSection(o,a,n);t.appendChild(l)}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const o=t.style.opacity;(o==="0"||!o||o==="")&&(t.style.transition=`opacity ${C.duration} ${C.timing}, transform ${C.duration} ${C.timing}`,t.style.opacity="1",t.style.transform="translateY(0)",setTimeout(()=>{t.style.opacity="",t.style.transform="",t.style.transition=""},C.timeout)),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const a=t.querySelectorAll(".projects-section");a.length>0&&x(a),requestAnimationFrame(()=>{requestAnimationFrame(()=>{const l=t.querySelectorAll(".project-card:not(.project-card-hidden)");l.length>0&&x(l)})})})})})});const r=async()=>{try{const{globalSvgLoader:o}=await L(async()=>{const{globalSvgLoader:l}=await import("./components-svg-D1ZYaihp.js");return{globalSvgLoader:l}},[]),a=o;await new Promise(l=>{window.requestIdleCallback?requestIdleCallback(()=>{a.init().then(l).catch(l)},{timeout:2e3}):setTimeout(()=>{a.init().then(l).catch(l)},0)})}catch(o){console.error("Ошибка загрузки SVG:",o)}finally{this.isRendering=!1}};window.requestIdleCallback?requestIdleCallback(r,{timeout:2e3}):setTimeout(r,100)}catch(s){console.error("Ошибка при рендеринге проектов:",s),this.isRendering=!1}}}class B{constructor(t){this.sectionSelector=t.sectionSelector,this.elementsSelector=t.elementsSelector,this.animationDelay=t.animationDelay||100}hideAllElementsImmediately(t=null){document.querySelectorAll(this.sectionSelector).forEach(s=>{s&&(s.style.setProperty("opacity","0","important"),s.style.setProperty("transform",`translateY(${C.translateYAppear})`,"important"),s.style.setProperty("transition","none","important"),s.querySelectorAll(this.elementsSelector).forEach(i=>{i&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform",`translateY(${C.translateYAppear})`,"important"),i.style.setProperty("transition","none","important"))}),t&&typeof t=="function"&&t(s))})}recheckAndHideElements(){document.querySelectorAll(this.sectionSelector).forEach(e=>{if(e){const s=window.getComputedStyle(e);parseFloat(s.opacity)>.01&&(e.style.setProperty("opacity","0","important"),e.style.setProperty("transform",`translateY(${C.translateYAppear})`,"important"),e.style.setProperty("transition","none","important")),e.querySelectorAll(this.elementsSelector).forEach(r=>{if(r){const o=window.getComputedStyle(r);parseFloat(o.opacity)>.01&&(r.style.setProperty("opacity","0","important"),r.style.setProperty("transform",`translateY(${C.translateYAppear})`,"important"),r.style.setProperty("transition","none","important"))}})}})}forceReflow(t=null){if(t&&t.firstElementChild)t.firstElementChild.offsetHeight;else{const e=document.querySelector(this.sectionSelector);e&&e.firstElementChild&&e.firstElementChild.offsetHeight}}initializeAnimations(){throw new Error("initializeAnimations() must be implemented in child class")}}class K extends B{constructor(){super({sectionSelector:".cv-section, #cv-download-section",elementsSelector:".cv-header-name, .cv-header-role, .cv-header-contacts-wrapper, .cv-header-about, .cv-about-text, .cv-header-photo-image, .cv-section-title, .cv-skills-grid, .cv-skill-category, .timeline-container, .cv-certificate-item, .cv-course-item, .cv-language-item, .cv-download-button",animationDelay:100})}hideAllCVElementsImmediately(){this.hideAllElementsImmediately(t=>{t.querySelectorAll(".timeline-container").forEach(s=>{s&&s.querySelectorAll("*").forEach(i=>{i&&(i.style.setProperty("opacity","0","important"),i.style.setProperty("transform","translateY(10px)","important"),i.style.setProperty("transition","none","important"))})})})}animateCVSection(t,e={}){if(!t)return;const s=e.delay||0;setTimeout(()=>{const n=[],i=t.querySelector(".cv-section-title");i&&n.push(i);const r=t.querySelectorAll(".timeline-container");r.forEach(d=>{d&&n.push(d)}),t.querySelectorAll(".cv-certificate-item").forEach(d=>{d&&n.push(d)}),t.querySelectorAll(".cv-course-item").forEach(d=>{d&&n.push(d)}),t.querySelectorAll(".cv-language-item").forEach(d=>{d&&n.push(d)}),t.querySelectorAll(".cv-download-button").forEach(d=>{n.push(d)}),F(t),r.forEach(d=>{d&&d.querySelectorAll("*").forEach(p=>{p&&(p.style.setProperty("opacity","",""),p.style.setProperty("transform","",""),p.style.setProperty("transition","",""),p.style.removeProperty("opacity"),p.style.removeProperty("transform"),p.style.removeProperty("transition"))})}),r.length>0&&r[0]&&r[0].offsetHeight,n.length>0&&x(n,{skipInitialState:!0})},s)}animateCVHeader(t){if(!t)return;F(t);const e=[],s=t.querySelector(".cv-header-name"),n=t.querySelector(".cv-header-role"),i=t.querySelector(".cv-header-contacts-wrapper"),r=t.querySelector(".cv-header-photo-image"),o=t.querySelector(".cv-header-about"),a=t.querySelectorAll(".cv-about-text"),l=t.querySelector(".cv-skills-grid"),c=t.querySelectorAll(".cv-skill-category");s&&e.push(s),n&&e.push(n),i&&e.push(i),r&&e.push(r),o&&e.push(o),a.forEach(d=>{d&&e.push(d)}),l&&e.push(l),c.forEach(d=>{d&&e.push(d)}),e.length>0&&x(e,{skipInitialState:!0})}initializeAnimations(){this.hideAllCVElementsImmediately(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.recheckAndHideElements(),setTimeout(()=>{const t=document.getElementById("cv-header-section"),e=[],s=[];if(t&&t.children.length>0){s.push(t);const i=t.querySelector(".cv-header-name"),r=t.querySelector(".cv-header-role"),o=t.querySelector(".cv-header-contacts-wrapper"),a=t.querySelector(".cv-header-photo-image"),l=t.querySelector(".cv-header-about"),c=t.querySelectorAll(".cv-about-text"),d=t.querySelector(".cv-skills-grid"),u=t.querySelectorAll(".cv-skill-category");i&&e.push(i),r&&e.push(r),o&&e.push(o),a&&e.push(a),l&&e.push(l),e.push(...c),d&&e.push(d),e.push(...u)}["cv-work-section","cv-education-section","cv-certificates-section","cv-courses-section","cv-languages-section","cv-download-section"].forEach(i=>{const r=document.getElementById(i);if(r&&r.children.length>0){s.push(r);const o=r.querySelector(".cv-section-title");o&&e.push(o),r.querySelectorAll(".timeline-container").forEach(p=>{p&&(e.push(p),p.querySelectorAll("*").forEach(v=>{v&&(v.style.removeProperty("opacity"),v.style.removeProperty("transform"),v.style.removeProperty("transition"))}))});const l=r.querySelectorAll(".cv-certificate-item"),c=r.querySelectorAll(".cv-course-item"),d=r.querySelectorAll(".cv-language-item"),u=r.querySelectorAll(".cv-download-button");e.push(...l,...c,...d,...u)}}),e.length>0&&(s.forEach(i=>{F(i)}),e[0].offsetHeight,x(e,{skipInitialState:!1}))},this.animationDelay)})})}}class z extends B{constructor(){super({sectionSelector:".community-section",elementsSelector:".community-section-title, .community-card, .community-card-discord, .community-events-list, .community-event-item",animationDelay:100})}hideAllCommunityElementsImmediately(){this.hideAllElementsImmediately()}initializeAnimations(){this.hideAllCommunityElementsImmediately(),this.forceReflow(document.querySelector(".community-section")),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.recheckAndHideElements();const t=document.querySelectorAll(this.sectionSelector);t.length>0&&t[0].firstElementChild&&t[0].firstElementChild.offsetHeight,setTimeout(()=>{const e=[];t.forEach(s=>{if(s&&s.children.length>0){F(s);const n=s.querySelector(".community-section-title");n&&e.push(n),s.querySelectorAll(".community-card, .community-card-discord").forEach(o=>{o&&e.push(o)}),s.querySelectorAll(".community-event-item").forEach(o=>{o&&e.push(o)})}}),e.length>0&&e[0]&&e[0].offsetHeight,e.length>0&&(e.forEach(s=>{if(s){const n=window.getComputedStyle(s);parseFloat(n.opacity)>.01&&(s.style.setProperty("opacity","0","important"),s.style.setProperty("transform","translateY(10px)","important"),s.style.setProperty("transition","none","important"))}}),e.length>0&&e[0]&&e[0].offsetHeight,x(e,{skipInitialState:!1}))},this.animationDelay)})})}}export{K as C,V as P,R as S,L as _,z as a,G as b};
