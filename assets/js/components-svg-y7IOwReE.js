class c{constructor(){this.loadedElements=new WeakSet}async loadSvg(t){const r=t.getAttribute("data-svg-src");if(r&&t.parentNode&&!(t.hasAttribute("data-svg-loaded")||this.loadedElements.has(t)))try{const e=await fetch(r);if(!e.ok)return;const o=await e.text(),s=new DOMParser().parseFromString(o,"image/svg+xml").documentElement;if(!t.parentNode)return;const a=t.getAttribute("class");a&&s.setAttribute("class",a),(t.classList.contains("language-icon-ru")||t.classList.contains("language-icon-en"))&&(s.removeAttribute("width"),s.removeAttribute("height")),t.parentNode.replaceChild(s,t),s.setAttribute("data-svg-loaded","true"),this.loadedElements.add(s)}catch(e){console.error("Ошибка при загрузке SVG:",e)}}async init(){const t=Array.from(document.querySelectorAll("[data-svg-src]:not([data-svg-loaded])")).filter(e=>e.parentNode);if(t.length===0)return;const r=10;for(let e=0;e<t.length;e+=r){const s=t.slice(e,e+r).map(a=>this.loadSvg(a));await Promise.allSettled(s),e+r<t.length&&await new Promise(a=>{window.requestIdleCallback?requestIdleCallback(()=>a(),{timeout:50}):setTimeout(a,0)})}}}export{c as SvgLoader};
