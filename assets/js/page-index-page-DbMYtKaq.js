import{B as m}from"./page-base-page-CSGblTmO.js";import{l as d,g,P as f}from"./utils-BGwBK1z0.js";import{SlidesManager as p}from"./components-D-B5HGai.js";import{b as C}from"./services-ERvBTkKF.js";import{S as h}from"./managers-BcZlKcHk.js";import"./components-scroll-DF6W2z7Q.js";import"./layout-B_i5Hhw_.js";import"./components-core-DxJLR8x9.js";import"./components-svg-y7IOwReE.js";import"./components-background-BXvjSBPs.js";class q extends m{constructor(){super({navigationSelector:"#cta-section",imageSelector:'.slide[data-slide="0"] img'}),this.slideAnimationManager=null,this.slidesContainer=null,this.slidesManager=null,this.featuredProjects=[]}async loadProjectsData(){return this.loadPageDataArray("/data/projects.json","projects",[])}getProjectSlides(){return this.slidesContainer?Array.from(this.slidesContainer.querySelectorAll(".slide[data-slide]")).filter(t=>{const e=parseInt(t.getAttribute("data-slide"));return e>0&&e<4}).sort((t,e)=>{const a=parseInt(t.getAttribute("data-slide")),i=parseInt(e.getAttribute("data-slide"));return a-i}):[]}populateProjectSlide(t,e,a=0){var r;const i=t.querySelector(".project-title");if(i){const n=d.getCurrentLanguage();let u=e.title;e.titleLocalized&&e.titleLocalized[n]&&(u=e.titleLocalized[n]),i.textContent=u.toUpperCase()}const o=t.querySelector(".project-meta");if(o&&e.displayMeta){const n=o.querySelectorAll("span");n.length>=2&&(n[0].textContent=e.displayMeta.genre,n[1].textContent=e.displayMeta.platform)}const s=t.querySelector(".details-block:first-of-type .details-text");if(s){const n=g(e.role,!0,e.teamName);s.textContent=n}const l=t.querySelector(".details-block:last-of-type .details-text");if(l&&e.keyContribution){const n=d.getCurrentLanguage();e.keyContributionLocalized&&e.keyContributionLocalized[n]?l.textContent=e.keyContributionLocalized[n]:l.textContent=e.keyContribution}if((r=e.media)!=null&&r.preview){const n=t.querySelector(".project-placeholder");n&&C.loadBackgroundImage(n,e.media.preview,!0)}}populateProjectSlides(t){const e=this.getProjectSlides();if(e.length===0){console.warn("Слайды проектов не найдены");return}const a=t.slice(0,e.length);if(a.length===0){console.warn("Featured проекты не найдены");return}a.forEach((i,o)=>{o<e.length&&this.populateProjectSlide(e[o],i,o)})}async initSlideAnimationManager(){if(this.slidesContainer)return this.slideAnimationManager||(this.slideAnimationManager=new h(this.slidesContainer)),this.slideAnimationManager}async init(){if(this.slidesContainer=document.querySelector(".slides-container"),!this.slidesContainer)return;await this.initBase(),this.initLoadingIndicator("index-loading","index-loading-container"),this.loadingIndicator.show();const t=this.loadProjectsData();this.slidesManager=new p,this.slidesManager.init();const e=await t;await this.loadingIndicator.hide(),this.featuredProjects=e.filter(a=>a.featured===!0),this.populateProjectSlides(this.featuredProjects),await this.initSlideAnimationManager(),await f.waitForFontsLoaded(),await new Promise(a=>requestAnimationFrame(()=>{requestAnimationFrame(a)})),this.slideAnimationManager&&this.slideAnimationManager.initializeFirstSlideAnimation(),this.languageChangeHandler=()=>{this.updateContentLanguage()},this.updateContentLanguage(),window.addEventListener("languageChanged",this.languageChangeHandler)}updateContentLanguage(){this.getProjectSlides().forEach((e,a)=>{const i=this.featuredProjects[a];if(!i)return;const o=e.querySelector(".project-title");if(o){const r=d.getCurrentLanguage();let n=i.title;i.titleLocalized&&i.titleLocalized[r]&&(n=i.titleLocalized[r]),o.textContent=n.toUpperCase()}const s=e.querySelector(".details-block:first-of-type .details-text");s&&(s.textContent=g(i.role,!0,i.teamName));const l=e.querySelector(".details-block:last-of-type .details-text");if(l&&i.keyContribution){const r=d.getCurrentLanguage();i.keyContributionLocalized&&i.keyContributionLocalized[r]?l.textContent=i.keyContributionLocalized[r]:l.textContent=i.keyContribution}})}cleanup(){var t;this.languageChangeHandler&&window.removeEventListener("languageChanged",this.languageChangeHandler),(t=super.cleanup)==null||t.call(this)}}async function z(){const c=document.querySelector(".slides-container");if(c)try{new h(c).hideAllSlideElementsImmediately()}catch(t){console.warn("Could not hide slide elements early:",t)}}export{q as IndexPage,z as hideAllSlideElementsEarly};
