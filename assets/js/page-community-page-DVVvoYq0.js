import{B as l}from"./page-base-page-CSGblTmO.js";import{C as r}from"./factories-BbPh88Zm.js";import{a as d}from"./managers-BcZlKcHk.js";import{l as a}from"./utils-BGwBK1z0.js";import"./components-scroll-DF6W2z7Q.js";import"./layout-B_i5Hhw_.js";import"./components-core-DxJLR8x9.js";import"./services-ERvBTkKF.js";import"./components-svg-y7IOwReE.js";class P extends l{constructor(){super({navigationSelector:".community-navigation",imageSelector:".community-page img, .community-section img"}),this.animationManager=null}async initAnimationManager(){return this.animationManager||(this.animationManager=new d),this.animationManager}getIconPath(t){return{discord:"assets/images/icon-discord.svg","discord-server":"assets/images/icon-discord-server.svg",patreon:"assets/images/icon-patreon.svg",boosty:"assets/images/icon-boosty.svg","ko-fi":"assets/images/icon-ko-fi.svg",github:"assets/images/icon-github.svg",itch:"assets/images/icon-itch.svg",telegram:"assets/images/icon-telegram.svg",linkedin:"assets/images/icon-linkedin.svg",headhunter:"assets/images/icon-headhunter.svg",steam:"assets/images/icon-steam.svg",mail:"assets/images/icon-mail.svg"}[t.toLowerCase()]||"assets/images/icon-placeholder.svg"}async loadCommunityData(){return this.loadPageData("/data/community.json",{},null)}createDiscordSection(t){if(!t)return null;const n=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.discord"),titleClassName:"community-section-title"}),e=!t.link||t.link==="https://discord.gg/...",o=r.createCommunityCard({url:t.link||"#",iconPath:this.getIconPath("discord-server"),platformName:a.t("community.discordServer.name"),ariaLabel:e?a.t("community.discordServer.comingSoon"):a.t("community.discordServer.join"),description:a.t("community.discord.join"),isDiscord:!0});n.appendChild(o);const i=o==null?void 0:o.querySelector(".community-card-icon-left");return o&&i&&(i.style.width="128px",i.style.minWidth="128px",i.style.height="128px"),n}createSocialSection(t){if(!t)return null;const n=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.social"),titleClassName:"community-section-title"}),e=document.createElement("div");return e.className="community-social-links",[{key:"steam",label:"Steam",url:t.steam},{key:"telegram",label:"Telegram",url:t.telegram},{key:"itch",label:"itch.io",url:t.itch}].forEach(i=>{const s=this.getIconPath(i.key),c=!i.url||i.url.includes("..."),m=r.createCommunityCard({url:i.url||"#",iconPath:s,platformName:i.label,ariaLabel:c?`${i.label} ${a.t("community.comingSoon")}`:i.label});e.appendChild(m)}),e.children.length>0?(n.appendChild(e),n):null}createDonationsSection(t){if(!t||t.length===0)return null;const n=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.donations"),titleClassName:"community-section-title"}),e=document.createElement("div");return e.className="community-donations-links",t.forEach(o=>{const i=this.getIconPath(o.id||o.platform),s=!o.url||o.url.includes("..."),c=r.createCommunityCard({url:o.url||"#",iconPath:i,platformName:o.platform,ariaLabel:s?`${o.platform} ${a.t("community.comingSoon")}`:`${a.t("community.donation.supportOn")} ${o.platform}`});e.appendChild(c)}),e.children.length>0?(n.appendChild(e),n):null}createWorkSection(t){if(!t)return null;const n=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.work"),titleClassName:"community-section-title"}),e=document.createElement("div");return e.className="community-social-links",[{key:"linkedin",label:"LinkedIn",url:t.linkedin},{key:"headhunter",label:"HeadHunter",url:t.headhunter},{key:"github",label:"GitHub",url:t.github},{key:"mail",label:"Email",url:t.mail}].forEach(i=>{const s=this.getIconPath(i.key),c=!i.url||i.url.includes("..."),m=r.createCommunityCard({url:i.url||"#",iconPath:s,platformName:i.label,ariaLabel:c?`${i.label} ${a.t("community.comingSoon")}`:i.label});e.appendChild(m)}),e.children.length>0?(n.appendChild(e),n):null}createEventsSection(t){if(!t||t.length===0)return null;const n=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.events"),titleClassName:"community-section-title"}),e=document.createElement("div");return e.className="community-events-list",t.forEach(o=>{const i=document.createElement("div");i.className="community-event-item";const s=document.createElement("h3");if(s.className="community-event-title",s.textContent=o.title||a.t("community.events.defaultTitle"),i.appendChild(s),o.date){const c=document.createElement("p");c.className="community-event-date",c.textContent=o.date,i.appendChild(c)}if(o.description){const c=document.createElement("p");c.className="community-event-description",c.textContent=o.description,i.appendChild(c)}e.appendChild(i)}),n.appendChild(e),n}addSectionToContainer(t,n){if(!t)return;t.style.setProperty("opacity","0","important"),t.style.setProperty("transform","translateY(10px)","important"),t.style.setProperty("transition","none","important");const e=document.getElementById(n);e&&e.appendChild(t)}handlePageshow(t){if(t.persisted){const n=document.querySelector(".community-section");n&&n.children.length>0&&setTimeout(()=>{this.animationManager&&this.animationManager.initializeAnimations()},100)}}async init(){await this.initBase(),this.languageChangeHandler=()=>{this.updateContentLanguage()},window.addEventListener("languageChanged",this.languageChangeHandler),this.initLoadingIndicator("community-loading","community-loading-container"),this.loadingIndicator.show(),await this.initAnimationManager(),this.animationManager&&this.animationManager.hideAllCommunityElementsImmediately();const t=await this.loadCommunityData();if(await this.loadingIndicator.hide(),!t)return;if(t.discord){const e=this.createDiscordSection(t.discord);this.addSectionToContainer(e,"community-discord-section")}if(t.socialLinks){const e=this.createSocialSection(t.socialLinks);this.addSectionToContainer(e,"community-social-section")}if(t.donationLinks){const e=this.createDonationsSection(t.donationLinks);this.addSectionToContainer(e,"community-donations-section")}if(t.workLinks){const e=this.createWorkSection(t.workLinks);this.addSectionToContainer(e,"community-work-section")}if(t.upcomingEvents){const e=this.createEventsSection(t.upcomingEvents);this.addSectionToContainer(e,"community-events-section")}await this.initAnimationManager(),this.animationManager&&this.animationManager.hideAllCommunityElementsImmediately(),await new Promise(e=>setTimeout(e,0)),await(await this.getSvgLoader()).init(),await this.waitForPageReady(),this.animationManager&&this.animationManager.initializeAnimations()}updateContentLanguage(){Object.entries({"community-discord-section":"community.sections.discord","community-social-section":"community.sections.social","community-donations-section":"community.sections.donations","community-work-section":"community.sections.work","community-events-section":"community.sections.events"}).forEach(([e,o])=>{const i=document.getElementById(e);if(i){const s=i.querySelector(".community-section-title");s&&(s.textContent=a.t(o))}}),document.querySelectorAll(".community-event-title").forEach(e=>{(!e.textContent||e.textContent==="Событие"||e.textContent==="Event")&&(e.textContent=a.t("community.events.defaultTitle"))});const n=document.querySelector(".community-card-discord");if(n){const e=n.querySelector(".community-card-title-text");if(e&&(e.textContent=a.t("community.discordServer.name")),n.getAttribute("aria-label")){const s=!n.href||n.href==="#";n.setAttribute("aria-label",s?a.t("community.discordServer.comingSoon"):a.t("community.discordServer.join"))}const i=n.querySelector(".community-card-description");i&&(a.getCurrentLanguage(),i.textContent=a.t("community.discord.join"))}}destroy(){this.languageChangeHandler&&window.removeEventListener("languageChanged",this.languageChangeHandler)}}export{P as CommunityPage};
