const i=new Map,s=new Map;class l{constructor(){this.headerElement=null,this.footerElement=null,this.scrollToTopContainer=null}async loadHTML(e){if(i.has(e))return Promise.resolve(i.get(e));if(s.has(e))return s.get(e);const o=fetch(e,{priority:"high",headers:{"Cache-Control":"max-age=300"}}).then(async t=>{if(!t.ok)throw new Error(`Failed to load HTML from ${e}`);const n=await t.text();return i.set(e,n),n}).catch(t=>{throw console.error(`Ошибка загрузки HTML из ${e}:`,t),t}).finally(()=>{s.delete(e)});return s.set(e,o),o}setActiveNavLink(){const e=document.querySelectorAll(".header-nav-item");let o=window.location.pathname.split("/").pop();(o===""||o==="index.html"||window.location.pathname==="/")&&(o="index.html"),e.forEach(t=>{t.getAttribute("href").split("/").pop()===o?t.classList.add("active"):t.classList.remove("active")})}async init(){this.headerElement=document.querySelector("header.header"),this.footerElement=document.querySelector("footer.footer"),this.scrollToTopContainer=document.querySelector("#scroll-to-top-container");const e=[this.headerElement?this.loadHTML("/components/header.html"):Promise.resolve(null),this.footerElement?this.loadHTML("/components/footer.html"):Promise.resolve(null)];document.body.classList.contains("page-with-scroll")&&this.scrollToTopContainer?e.push(this.loadHTML("/components/scroll-to-top.html")):e.push(Promise.resolve(null));const[o,t,n]=await Promise.all(e);this.headerElement&&o&&(this.headerElement.innerHTML=o,this.setActiveNavLink()),this.footerElement&&t&&(this.footerElement.innerHTML=t),this.scrollToTopContainer&&n&&(this.scrollToTopContainer.innerHTML=n)}}export{l as L};
