class A{static waitForFontsLoaded(){return new Promise(t=>{document.fonts&&document.fonts.ready?document.fonts.ready.then(()=>{setTimeout(t,50)}).catch(()=>{t()}):setTimeout(t,200)})}static waitForImagesLoaded(t="img"){return new Promise(e=>{const a=document.querySelectorAll(t);if(a.length===0){e();return}let i=0;const n=a.length;let s=!1;const c=()=>{i++,i>=n&&!s&&(s=!0,setTimeout(e,100))};a.forEach(l=>{l.complete&&l.naturalHeight!==0?c():(l.addEventListener("load",c,{once:!0}),l.addEventListener("error",c,{once:!0}))}),setTimeout(()=>{s||(s=!0,e())},3e3)})}static waitForPageReady(t="img"){return new Promise(e=>{document.readyState==="complete"?Promise.all([this.waitForImagesLoaded(t),this.waitForFontsLoaded()]).then(()=>e()):window.addEventListener("load",()=>{Promise.all([this.waitForImagesLoaded(t),this.waitForFontsLoaded()]).then(()=>e())},{once:!0})})}}class S{static setActiveNavigationLink(t){const e=document.querySelectorAll(`${t} .cta-button`);let a=window.location.pathname.split("/").pop();(a===""||a==="index.html"||window.location.pathname==="/")&&(a="index.html"),e.forEach(i=>{i.getAttribute("href").split("/").pop()===a?i.classList.add("active"):i.classList.remove("active")})}}class ${constructor(t,e=".page-wrapper"){this.navigationSelector=t,this.pageWrapperSelector=e,this.menuButton=null,this.navigationSection=null,this.pageWrapper=null,this.isInitialized=!1}init(){this.isInitialized||(this.navigationSection=document.querySelector(this.navigationSelector),this.pageWrapper=document.querySelector(this.pageWrapperSelector),!(!this.navigationSection||!this.pageWrapper)&&this.waitForMenuButton())}waitForMenuButton(){let t=0;const e=20,a=()=>{if(this.menuButton=document.querySelector(".header-menu-button"),!this.menuButton){if(t++,t>=e){console.warn("Кнопка меню не найдена после ожидания");return}setTimeout(a,50);return}const i=`${this.navigationSelector.replace(/[^a-zA-Z0-9]/g,"_")}_scroll_handler`;this.menuButton.dataset[i]!=="true"&&(this.menuButton.addEventListener("click",()=>{const n=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight);window.scrollTo({top:n,behavior:"smooth"})}),this.menuButton.dataset[i]="true",this.isInitialized=!0)};a()}}class m{constructor(){this.currentLanguage="ru",this.translations={},this.listeners=new Set}isUserFromCIS(){const t=navigator.language||navigator.userLanguage||"",e=["ru","uk","be","kk","uz","hy","az","ky","tg","tk","mo"];if(e.some(a=>t.toLowerCase().startsWith(a)))return!0;if(navigator.languages){for(const a of navigator.languages)if(e.some(i=>a.toLowerCase().startsWith(i)))return!0}try{const a=Intl.DateTimeFormat().resolvedOptions().timeZone;if(["Europe/Moscow","Europe/Minsk","Asia/Almaty","Asia/Bishkek","Asia/Yerevan","Asia/Baku","Europe/Chisinau","Asia/Dushanbe","Asia/Tashkent","Asia/Ashgabat","Europe/Kiev","Europe/Kyiv"].includes(a))return!0}catch{}return!1}detectDefaultLanguage(){const t=localStorage.getItem("language");return t==="ru"||t==="en"?t:this.isUserFromCIS()?"ru":"en"}async init(t=null){t||(t=this.detectDefaultLanguage()),this.currentLanguage=t,await this.loadTranslations(this.currentLanguage)}async loadTranslations(t){try{const e=await fetch(`/data/locales/${t}.json`);if(!e.ok)throw new Error(`Failed to load translations for ${t}`);this.translations=await e.json(),this.currentLanguage=t,localStorage.setItem("language",t),document.documentElement.lang=t,navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(document.body.style.fontSize=getComputedStyle(document.body).fontSize,requestAnimationFrame(()=>{document.body.style.fontSize=""})),this.notifyListeners()}catch(e){console.error("Error loading translations:",e),t!=="ru"&&await this.loadTranslations("ru")}}t(t,e={}){const a=t.split(".");let i=this.translations;for(const n of a)if(i&&typeof i=="object"&&n in i)i=i[n];else return console.warn(`Translation key not found: ${t}`),t;return typeof i!="string"?(console.warn(`Translation value is not a string: ${t}`),t):Object.keys(e).length>0?i.replace(/\{\{(\w+)\}\}/g,(n,s)=>e[s]!==void 0?e[s]:n):i}getCurrentLanguage(){return this.currentLanguage}async switchLanguage(t){t!==this.currentLanguage&&await this.loadTranslations(t)}subscribe(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){this.listeners.forEach(t=>{try{t(this.currentLanguage,this.translations)}catch(e){console.error("Error in localization listener:",e)}})}}const p=new m;function d(r,t){return typeof window>"u"||!document.documentElement?t:getComputedStyle(document.documentElement).getPropertyValue(`--${r}`).trim()||t}function h(r){const t=r.match(/^([\d.]+)(s|ms)$/);if(!t)return 300;const e=parseFloat(t[1]);return t[2]==="s"?e*1e3:e}const o={get duration(){return d("transition-duration-base","0.3s")},get timing(){return d("timing-function-ease-in-out","ease-in-out")},translateYAppear:"10px",translateYDisappear:"-10px",translateYFinal:"0",get timeout(){return h(this.duration)}};function g(r,t={}){if(!r)return;const e={duration:t.duration||o.duration,timing:t.timing||o.timing,translateYAppear:t.translateYAppear||o.translateYAppear,translateYFinal:t.translateYFinal||o.translateYFinal,timeout:t.timeout||o.timeout,skipInitialState:t.skipInitialState||!1};r.style.display==="none"&&(r.style.display=""),e.skipInitialState||(r.style.opacity="0",r.style.transform=`translateY(${e.translateYAppear})`,r.style.transition="none",r.offsetHeight),requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(!e.skipInitialState)r.style.opacity="0",r.style.transform=`translateY(${e.translateYAppear})`,r.style.transition="none";else{const a=window.getComputedStyle(r),i=parseFloat(a.opacity),n=r.style.opacity,s=r.style.transform,c=r.style.transition;(i>.01||!n||n===""||!s||s===""||c&&c!=="none")&&(r.style.setProperty("opacity","0","important"),r.style.setProperty("transform",`translateY(${e.translateYAppear})`,"important"),r.style.setProperty("transition","none","important"),r.offsetHeight)}requestAnimationFrame(()=>{const a=window.getComputedStyle(r),i=parseFloat(a.opacity),n=r.style.opacity,s=r.style.transform;(i>.01||!n||n===""||!s||s==="")&&(r.style.setProperty("opacity","0","important"),r.style.setProperty("transform",`translateY(${e.translateYAppear})`,"important"),r.style.setProperty("transition","none","important"),r.offsetHeight),r.style.removeProperty("transition"),r.style.transition=`opacity ${e.duration} ${e.timing}, transform ${e.duration} ${e.timing}`,r.offsetHeight,r.style.removeProperty("opacity"),r.style.removeProperty("transform"),r.style.opacity="1",r.style.transform=`translateY(${e.translateYFinal})`,setTimeout(()=>{r.style.removeProperty("transform"),r.style.removeProperty("opacity"),r.style.removeProperty("transition")},e.timeout)})})})}function b(r,t={}){if(!r||r.length===0)return;const e=Array.isArray(r)?r:Array.from(r),a=t.translateYAppear||o.translateYAppear,i=t.skipInitialState||!1;i||(e.forEach(n=>{n&&(n.style.setProperty("opacity","0","important"),n.style.setProperty("transform",`translateY(${a})`,"important"),n.style.setProperty("transition","none","important"))}),e.length>0&&e[0]&&e[0].offsetHeight),requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.forEach(n=>{if(n)if(i){const s=window.getComputedStyle(n),c=parseFloat(s.opacity),l=n.style.opacity,u=n.style.transform;(c>.01||!l||l===""||!u||u==="")&&(n.style.setProperty("opacity","0","important"),n.style.setProperty("transform",`translateY(${a})`,"important"),n.style.setProperty("transition","none","important"))}else n.style.setProperty("opacity","0","important"),n.style.setProperty("transform",`translateY(${a})`,"important"),n.style.setProperty("transition","none","important")}),e.length>0&&e[0]&&e[0].offsetHeight,requestAnimationFrame(()=>{const n={duration:t.duration||o.duration,timing:t.timing||o.timing,translateYFinal:t.translateYFinal||o.translateYFinal,timeout:t.timeout||o.timeout};e.forEach(s=>{s&&(s.style.removeProperty("transition"),s.style.transition=`opacity ${n.duration} ${n.timing}, transform ${n.duration} ${n.timing}`)}),e.length>0&&e[0]&&e[0].offsetHeight,e.forEach(s=>{s&&(s.style.removeProperty("opacity"),s.style.removeProperty("transform"),s.style.opacity="1",s.style.transform=`translateY(${n.translateYFinal})`)}),setTimeout(()=>{e.forEach(s=>{s&&(s.style.removeProperty("transform"),s.style.removeProperty("opacity"),s.style.removeProperty("transition"))})},n.timeout)})})})}function P(r,t={}){if(!r)return;const e={duration:t.duration||o.duration,timing:t.timing||o.timing,translateYAppear:t.translateYAppear||o.translateYAppear,translateYFinal:t.translateYFinal||o.translateYFinal,timeout:t.timeout||o.timeout};r.style.visibility="visible",r.style.display=r.style.display||"block",g(r,e)}const f=new Map,y=new Map,v=300*1e3;async function F(r,t={}){const e=f.get(r);if(e){const{data:i,timestamp:n}=e;if(Date.now()-n<v)return Promise.resolve(i);f.delete(r)}if(y.has(r))return y.get(r);const a=fetch(r,{...t,priority:t.priority||"high",keepalive:!0,headers:{"Cache-Control":"max-age=300",...t.headers}}).then(async i=>{if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const n=await i.json();return f.set(r,{data:n,timestamp:Date.now()}),n}).catch(i=>{throw console.error(`Ошибка загрузки данных из ${r}:`,i),i}).finally(()=>{y.delete(r)});return y.set(r,a),a}async function L(r,t,e){if(!e)throw new Error("loadHTMLFunction is required");try{const a=await e(r),i=document.createElement("div");i.innerHTML=a;const n=t&&i.querySelector(t)||i.firstElementChild;return n||(console.error(`Не удалось найти элемент в шаблоне ${r} по селектору ${t||"firstElementChild"}`),null)}catch(a){return console.error(`Ошибка загрузки шаблона ${r}:`,a),null}}class Y{static hideElementsForAnimation(t,e={}){const a={opacity:e.opacity||"0",transform:e.transform||"translateY(10px)",important:e.important!==!1};(Array.isArray(t)?t:Array.from(t)).forEach(n=>{n&&(a.important?(n.style.setProperty("opacity",a.opacity,"important"),n.style.setProperty("transform",a.transform,"important"),n.style.setProperty("transition","none","important")):(n.style.opacity=a.opacity,n.style.transform=a.transform,n.style.transition="none"))})}static isElementVisible(t){if(!t)return!1;const e=window.getComputedStyle(t),a=parseFloat(e.opacity),i=e.visibility,n=e.display;return a>.01&&i!=="hidden"&&n!=="none"}static forceReflow(t){t&&t.offsetHeight}static clearAnimationStyles(t){(Array.isArray(t)?t:Array.from(t)).forEach(a=>{a&&(a.style.removeProperty("opacity"),a.style.removeProperty("transform"),a.style.removeProperty("transition"))})}}function E(r,t=!1,e=null){const i={solo:t?"soloDetailed":"solo","team-lead":t?"teamLeadDetailed":"teamLead",team:"team"}[r];let n=i?p.t(`roles.${i}`):r;if(e&&r==="team-lead"&&t){const s=p.t("roles.teamName");n=`${n} (${s} ${e})`}return n}class I{static getStatusText(t){const a={published:"published","in-publication":"inPublication","in-progress":"inProgress"}[t];return a?p.t(`research.statuses.${a}`):t}static getTypeText(t){const a={thesis:"thesis",article:"article",diploma:"diploma"}[t];return a?p.t(`research.types.${a}`):t}}class w{constructor(){this.observer=null,this.observedImages=new WeakSet}initObserver(){this.observer||(this.observer=new IntersectionObserver(t=>{t.forEach(e=>{if(e.isIntersecting){const a=e.target,i=a.dataset.src;i&&(a.src=i,a.removeAttribute("data-src"),this.observer.unobserve(a),this.observedImages.delete(a))}})},{rootMargin:"100px",threshold:.01}))}loadImage(t){!t||!t.dataset.src||this.observedImages.has(t)||t.src&&!t.dataset.src||(this.initObserver(),this.observer.observe(t),this.observedImages.add(t))}loadAllImages(){document.querySelectorAll("img[data-src]").forEach(e=>this.loadImage(e))}disconnect(){this.observer&&(this.observer.disconnect(),this.observer=null),this.observedImages=new WeakSet}}const T=new w;class k{static formatPeriod(t,e="ru"){if(!t)return"";let a=t.start||"",i=t.end||(e==="en"?"present":"настоящее время");if(e==="en"){const s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(a&&a.match(/^\d{4}-\d{2}$/)){const[c,l]=a.split("-"),u=parseInt(l,10)-1;a=`${s[u]} ${c}`}else a&&a.match(/^\d{4}$/)&&(a=a);if(i&&i.match(/^\d{4}-\d{2}$/)){const[c,l]=i.split("-"),u=parseInt(l,10)-1;i=`${s[u]} ${c}`}else i&&i.match(/^\d{4}$/)&&(i=i)}let n="";return t.durationLocalized&&t.durationLocalized[e]?n=` (${t.durationLocalized[e]})`:t.duration&&(n=` (${t.duration})`),`${a} — ${i}${n}`}static formatDate(t){if(!t)return"";if(t.year)return t.year.toString();if(t.start&&t.end){const e=new Date(t.start),a=new Date(t.end);return`${e.getDate()}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()} — ${a.getDate()}.${String(a.getMonth()+1).padStart(2,"0")}.${a.getFullYear()}`}if(t.start){const e=new Date(t.start);return`${e.getDate()}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`}return""}static getYearFromDate(t){return t.year?t.year:t.start?new Date(t.start).getFullYear():t.end?new Date(t.end).getFullYear():null}}export{o as A,k as D,$ as M,S as N,A as P,I as S,b as a,g as b,T as c,P as d,F as e,L as f,E as g,Y as h,p as l};
