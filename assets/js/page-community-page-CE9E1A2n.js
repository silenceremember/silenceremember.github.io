import{B as l}from"./page-base-page-DE7KUBcH.js";import{C as r}from"./factories-ClXea4bO.js";import{a as d}from"./managers-BD3WS2NZ.js";import{l as a}from"./utils-DDkmD0RB.js";import"./components-scroll-CzkIP5QM.js";import"./layout-C0B9eYKg.js";import"./components-core-CO-goFmY.js";import"./services-CkGXMzVl.js";class b extends l{constructor(){super({navigationSelector:".community-navigation",imageSelector:".community-page img, .community-section img"}),this.animationManager=null}async initAnimationManager(){return this.animationManager||(this.animationManager=new d),this.animationManager}getIconPath(t){return{discord:"assets/images/icon-discord.svg","discord-server":"assets/images/icon-discord-server.svg",patreon:"assets/images/icon-patreon.svg",boosty:"assets/images/icon-boosty.svg","ko-fi":"assets/images/icon-ko-fi.svg",github:"assets/images/icon-github.svg",itch:"assets/images/icon-itch.svg",telegram:"assets/images/icon-telegram.svg",linkedin:"assets/images/icon-linkedin.svg",headhunter:"assets/images/icon-headhunter.svg",steam:"assets/images/icon-steam.svg",mail:"assets/images/icon-mail.svg"}[t.toLowerCase()]||"assets/images/icon-placeholder.svg"}async loadCommunityData(){return this.loadPageData("/data/community.json",{},null)}createDiscordSection(t){if(!t)return null;const o=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.discord"),titleClassName:"community-section-title"}),i=!t.link||t.link==="https://discord.gg/...",e=r.createCommunityCard({url:t.link||"#",iconPath:this.getIconPath("discord-server"),platformName:a.t("community.discordServer.name"),ariaLabel:i?a.t("community.discordServer.comingSoon"):a.t("community.discordServer.join"),description:a.t("community.discord.join"),isDiscord:!0});o.appendChild(e);const n=e==null?void 0:e.querySelector(".community-card-icon-left");return e&&n&&(n.style.width="128px",n.style.minWidth="128px",n.style.height="128px"),o}createSocialSection(t){if(!t)return null;const o=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.social"),titleClassName:"community-section-title"}),i=document.createElement("div");return i.className="community-social-links",[{key:"steam",label:"Steam",url:t.steam},{key:"telegram",label:"Telegram",url:t.telegram},{key:"itch",label:"itch.io",url:t.itch}].forEach(n=>{const s=this.getIconPath(n.key),c=!n.url||n.url.includes("..."),m=r.createCommunityCard({url:n.url||"#",iconPath:s,platformName:n.label,ariaLabel:c?`${n.label} ${a.t("community.comingSoon")}`:n.label});i.appendChild(m)}),i.children.length>0?(o.appendChild(i),o):null}createDonationsSection(t){if(!t||t.length===0)return null;const o=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.donations"),titleClassName:"community-section-title"}),i=document.createElement("div");return i.className="community-donations-links",t.forEach(e=>{const n=this.getIconPath(e.id||e.platform),s=!e.url||e.url.includes("..."),c=r.createCommunityCard({url:e.url||"#",iconPath:n,platformName:e.platform,ariaLabel:s?`${e.platform} ${a.t("community.comingSoon")}`:`${a.t("community.donation.supportOn")} ${e.platform}`});i.appendChild(c)}),i.children.length>0?(o.appendChild(i),o):null}createWorkSection(t){if(!t)return null;const o=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.work"),titleClassName:"community-section-title"}),i=document.createElement("div");return i.className="community-social-links",[{key:"linkedin",label:"LinkedIn",url:t.linkedin},{key:"headhunter",label:"HeadHunter",url:t.headhunter},{key:"github",label:"GitHub",url:t.github},{key:"mail",label:"Email",url:t.mail}].forEach(n=>{const s=this.getIconPath(n.key),c=!n.url||n.url.includes("..."),m=r.createCommunityCard({url:n.url||"#",iconPath:s,platformName:n.label,ariaLabel:c?`${n.label} ${a.t("community.comingSoon")}`:n.label});i.appendChild(m)}),i.children.length>0?(o.appendChild(i),o):null}createEventsSection(t){if(!t||t.length===0)return null;const o=this.createSectionWithTitle({className:"community-section",title:a.t("community.sections.events"),titleClassName:"community-section-title"}),i=document.createElement("div");return i.className="community-events-list",t.forEach(e=>{const n=document.createElement("div");n.className="community-event-item";const s=document.createElement("h3");if(s.className="community-event-title",s.textContent=e.title||a.t("community.events.defaultTitle"),n.appendChild(s),e.date){const c=document.createElement("p");c.className="community-event-date",c.textContent=e.date,n.appendChild(c)}if(e.description){const c=document.createElement("p");c.className="community-event-description",c.textContent=e.description,n.appendChild(c)}i.appendChild(n)}),o.appendChild(i),o}addSectionToContainer(t,o){if(!t)return;t.style.setProperty("opacity","0","important"),t.style.setProperty("transform","translateY(10px)","important"),t.style.setProperty("transition","none","important");const i=document.getElementById(o);i&&i.appendChild(t)}handlePageshow(t){if(t.persisted){const o=document.querySelector(".community-section");o&&o.children.length>0&&setTimeout(()=>{this.animationManager&&this.animationManager.initializeAnimations()},100)}}async init(){await this.initBase(),this.languageChangeHandler=()=>{this.updateContentLanguage()},window.addEventListener("languageChanged",this.languageChangeHandler),this.initLoadingIndicator("community-loading","community-loading-container"),this.loadingIndicator.show();const[t]=await Promise.all([this.loadCommunityData(),this.initAnimationManager()]);if(this.animationManager&&this.animationManager.hideAllCommunityElementsImmediately(),await this.loadingIndicator.hide(),!t)return;if(t.discord){const e=this.createDiscordSection(t.discord);this.addSectionToContainer(e,"community-discord-section")}if(t.socialLinks){const e=this.createSocialSection(t.socialLinks);this.addSectionToContainer(e,"community-social-section")}if(t.donationLinks){const e=this.createDonationsSection(t.donationLinks);this.addSectionToContainer(e,"community-donations-section")}if(t.workLinks){const e=this.createWorkSection(t.workLinks);this.addSectionToContainer(e,"community-work-section")}if(t.upcomingEvents){const e=this.createEventsSection(t.upcomingEvents);this.addSectionToContainer(e,"community-events-section")}this.animationManager&&this.animationManager.hideAllCommunityElementsImmediately(),await new Promise(e=>requestAnimationFrame(e));const o=await this.getSvgLoader();document.querySelectorAll("[data-svg-src]:not([data-svg-loaded])").length>0&&await o.init(),await this.waitForPageReady(),this.animationManager&&this.animationManager.initializeAnimations()}updateContentLanguage(){Object.entries({"community-discord-section":"community.sections.discord","community-social-section":"community.sections.social","community-donations-section":"community.sections.donations","community-work-section":"community.sections.work","community-events-section":"community.sections.events"}).forEach(([i,e])=>{const n=document.getElementById(i);if(n){const s=n.querySelector(".community-section-title");s&&(s.textContent=a.t(e))}}),document.querySelectorAll(".community-event-title").forEach(i=>{(!i.textContent||i.textContent==="Событие"||i.textContent==="Event")&&(i.textContent=a.t("community.events.defaultTitle"))});const o=document.querySelector(".community-card-discord");if(o){const i=o.querySelector(".community-card-title-text");if(i&&(i.textContent=a.t("community.discordServer.name")),o.getAttribute("aria-label")){const s=!o.href||o.href==="#";o.setAttribute("aria-label",s?a.t("community.discordServer.comingSoon"):a.t("community.discordServer.join"))}const n=o.querySelector(".community-card-description");n&&(a.getCurrentLanguage(),n.textContent=a.t("community.discord.join"))}}destroy(){this.languageChangeHandler&&window.removeEventListener("languageChanged",this.languageChangeHandler)}}export{b as CommunityPage};
