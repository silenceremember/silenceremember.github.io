class d{constructor(t="scroll-to-top"){this.buttonId=t,this.scrollToTopButton=null,this.footer=null,this.pageWrapper=null,this.lastScrollTop=0,this.hideTimeout=null,this.isAnimating=!1,this.wasShown=!1,this.wasScrollingDown=!1,this.initAttempts=0,this.MAX_INIT_ATTEMPTS=10,this.previousIsTabletMode=!1,this.scrollManager=null}init(){if(this.scrollToTopButton=document.getElementById(this.buttonId),!this.scrollToTopButton){this.initAttempts++,this.initAttempts<this.MAX_INIT_ATTEMPTS?setTimeout(()=>{this.init()},100):console.warn('Кнопка "Наверх" не найдена после нескольких попыток инициализации');return}this.initAttempts=0,this.footer=document.querySelector(".footer"),this.pageWrapper=document.querySelector(".page-wrapper"),this.setupEventListeners(),this.lastScrollTop=this.getScrollTop(),this.handleScroll(),this.updateButtonPosition()}isTabletMode(){return window.innerWidth<1024||window.innerHeight<900}isScrollPage(){return document.body.classList.contains("page-with-scroll")}getScrollElement(){return this.isTabletMode()||this.isScrollPage()?window:this.pageWrapper||window}getScrollTop(){const t=this.getScrollElement();return t===window?window.pageYOffset||document.documentElement.scrollTop:t.scrollTop}setScrollManager(t){this.scrollManager=t}updateButtonPositionDirect(t){!this.scrollToTopButton||!this.footer||this.isTabletMode()}updateButtonPosition(){if(!this.footer){this.scrollToTopButton.classList.remove("footer-hidden"),this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.opacity="";return}this.isTabletMode()?(this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.transition="",this.scrollToTopButton.style.opacity="",this.scrollToTopButton.classList.remove("footer-hidden")):(this.footer.classList.contains("hidden")?this.scrollToTopButton.classList.add("footer-hidden"):this.scrollToTopButton.classList.remove("footer-hidden"),this.scrollToTopButton.style.transform="",this.scrollToTopButton.style.transition="",this.scrollToTopButton.style.opacity="")}showButton(){if(this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null,this.isAnimating=!1),this.scrollToTopButton.classList.contains("visible")&&!this.isAnimating){this.updateButtonPosition();return}!this.wasShown||this.scrollToTopButton.style.display==="none"?(this.isAnimating=!0,this.scrollToTopButton.style.display==="none"&&(this.scrollToTopButton.style.display="flex"),this.scrollToTopButton.classList.remove("visible"),this.updateButtonPosition(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.scrollToTopButton.classList.add("visible"),this.wasShown=!0,setTimeout(()=>{this.isAnimating=!1},300)})})):(this.scrollToTopButton.style.display==="none"&&(this.scrollToTopButton.style.display="flex"),this.scrollToTopButton.classList.add("visible"),this.updateButtonPosition())}hideButton(){!this.scrollToTopButton.classList.contains("visible")&&this.scrollToTopButton.style.display==="none"||(this.hideTimeout&&clearTimeout(this.hideTimeout),this.isAnimating=!0,this.scrollToTopButton.classList.remove("visible"),this.hideTimeout=setTimeout(()=>{this.scrollToTopButton.classList.contains("visible")||(this.scrollToTopButton.style.display="none",this.wasShown=!1),this.isAnimating=!1,this.hideTimeout=null},300))}handleScroll(){const t=this.getScrollTop(),e=t<this.lastScrollTop,i=t<=0;e&&!i?(this.wasScrollingDown&&e||!this.wasShown?this.showButton():this.scrollToTopButton.classList.contains("visible")?this.updateButtonPosition():(this.scrollToTopButton.style.display==="none"&&(this.scrollToTopButton.style.display="flex"),this.scrollToTopButton.classList.add("visible"),this.updateButtonPosition()),this.wasScrollingDown=!1):(i||(this.wasScrollingDown=!0),this.hideButton()),this.lastScrollTop=t<=0?0:t,requestAnimationFrame(()=>{this.updateButtonPosition()})}setupEventListeners(){this.scrollToTopButton.addEventListener("click",()=>{const t=this.getScrollElement();t===window?window.scrollTo({top:0,behavior:"smooth"}):t.scrollTo({top:0,behavior:"smooth"})}),this.footer&&new MutationObserver(()=>{requestAnimationFrame(()=>{this.updateButtonPosition()})}).observe(this.footer,{attributes:!0,attributeFilter:["class"]}),this.setupScrollListener(),this.previousIsTabletMode=this.isTabletMode(),window.addEventListener("resize",()=>{const t=this.isTabletMode();t!==this.previousIsTabletMode&&(this.updateScrollListener(),this.previousIsTabletMode=t),this.handleScroll()})}setupScrollListener(){const t=this.getScrollElement();this.handleScrollBound=this.handleScroll.bind(this),t.addEventListener("scroll",this.handleScrollBound,{passive:!0})}updateScrollListener(){window.removeEventListener("scroll",this.handleScrollBound),this.pageWrapper&&this.pageWrapper.removeEventListener("scroll",this.handleScrollBound),this.lastScrollTop=this.getScrollTop(),this.setupScrollListener(),this.handleScroll()}}class u{constructor(t,e){this.scrollContainerSelector=t,this.isTabletModeCallback=e,this.scrollContainer=null,this.header=null,this.footer=null,this.decorativeLines=null,this.spacerElement=null,this.isTabletMode=!1,this.lastScrollTop=0,this.isInitialized=!1,this.ticking=!1,this.isScrolling=!1,this.scrollTimeout=null,this.headerFooterHeight=0,this.currentTranslateY=0,this.scrollToTopButton=null}init(){this.scrollContainer=document.querySelector(this.scrollContainerSelector),this.scrollContainer&&(this.header=document.querySelector(".header"),this.footer=document.querySelector(".footer"),this.decorativeLines=document.querySelectorAll(".decorative-line-horizontal"),!(!this.header||!this.footer||this.decorativeLines.length===0)&&(this.isScrollPage=document.body.classList.contains("page-with-scroll"),this.updateHeaderFooterHeight(),this.checkViewportForScroll(),window.addEventListener("resize",()=>{this.updateHeaderFooterHeight(),this.updateSpacerElement(),this.checkViewportForScroll()})))}updateHeaderFooterHeight(){this.headerFooterHeight=this.getHeaderFooterHeight()}getScrollElement(){return this.isTabletMode||this.isScrollPage?window:this.scrollContainer}getHeaderFooterHeight(){if(!this.header||!this.footer)return 0;const t=document.documentElement,e=getComputedStyle(t).getPropertyValue("--header-footer-height");if(e){const o=parseFloat(e);if(!isNaN(o))return o}const i=this.header.offsetHeight||0,s=this.footer.offsetHeight||0;return Math.max(i,s)}createSpacerElement(){let t=document.querySelector(".page-wrapper");t||(t=this.scrollContainer),t||(t=document.querySelector(".content-wrapper")),t&&(this.spacerElement&&this.spacerElement.remove(),this.spacerElement=document.createElement("div"),this.spacerElement.className="scroll-spacer-footer",this.spacerElement.style.cssText=`
      width: 100%;
      height: 0;
      pointer-events: none;
      visibility: hidden;
      flex-shrink: 0;
      box-sizing: border-box;
    `,t.appendChild(this.spacerElement),this.updateSpacerElement())}updateSpacerElement(){if(!this.spacerElement)return;const t=this.getHeaderFooterHeight(),e=20;this.spacerElement.style.height=`${t+e}px`}handleScroll(){this.isScrolling=!0,this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.onScrollEnd()},150),this.ticking||(window.requestAnimationFrame(()=>{this.updateHeaderFooterVisibility(),this.ticking=!1}),this.ticking=!0)}onScrollEnd(){if(this.isScrolling=!1,this.isTabletMode||!this.isScrollPage)return;const t=this.getScrollElement();let e,i,s;t===window?(e=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight,s=window.innerHeight):(e=t.scrollTop,i=t.scrollHeight,s=t.clientHeight);const o=e<=10,r=e+s>=i-10;if(o||r){this.animateToFullyVisible();return}Math.abs(this.currentTranslateY)>this.headerFooterHeight/2?this.animateToFullyHidden():this.animateToFullyVisible()}animateToFullyVisible(){this.currentTranslateY=0,this.showHeaderFooter()}animateToFullyHidden(){this.currentTranslateY=-this.headerFooterHeight,this.hideHeaderFooter()}updateHeaderFooterVisibility(){if(this.isTabletMode)return;const t=this.getScrollElement();let e,i,s;if(t===window?(e=window.pageYOffset||document.documentElement.scrollTop,i=document.documentElement.scrollHeight,s=window.innerHeight):(e=t.scrollTop,i=t.scrollHeight,s=t.clientHeight),!this.isScrollPage)return;const o=e<=10,r=e+s>=i-10,l=e-this.lastScrollTop,a=l>0,c=l<0,n=.5;o||r?this.showHeaderFooter():a&&Math.abs(l)>n?this.hideHeaderFooter():c&&Math.abs(l)>n&&this.showHeaderFooter(),this.lastScrollTop=e<=0?0:e}setScrollToTopButton(t){this.scrollToTopButton=t}showHeaderFooter(){this.header.classList.remove("hidden"),this.footer.classList.remove("hidden"),this.decorativeLines.forEach(t=>t.classList.remove("hidden")),this.currentTranslateY=0}hideHeaderFooter(){this.header.classList.add("hidden"),this.footer.classList.add("hidden"),this.decorativeLines.forEach(t=>t.classList.add("hidden")),this.currentTranslateY=-this.headerFooterHeight}checkViewportForScroll(){document.querySelector(".slides-container"),this.isScrollPage=document.body.classList.contains("page-with-scroll"),!this.isInitialized&&this.isScrollPage&&window.innerWidth>=1024&&window.innerHeight>=900&&this.createSpacerElement();const t=window.innerWidth<1024||window.innerHeight<900,e=this.isTabletMode;if(t===this.isTabletMode&&this.isScrollPage&&this.isInitialized)return;this.isTabletMode=t,e!==this.isTabletMode&&(this.isTabletMode?(this.showHeaderFooter(),this.currentTranslateY=0):this.currentTranslateY=0),!this.isTabletMode&&this.isScrollPage?this.spacerElement?this.updateSpacerElement():this.createSpacerElement():this.spacerElement&&(this.spacerElement.remove(),this.spacerElement=null),this.isTabletModeCallback&&this.isTabletModeCallback(this.isTabletMode),(e||this.isScrollPage&&!e)&&window.removeEventListener("scroll",this.handleScrollBound),!e&&!this.isScrollPage&&this.scrollContainer.removeEventListener("scroll",this.handleScrollBound);const i=this.getScrollElement();i===window?this.lastScrollTop=window.pageYOffset||document.documentElement.scrollTop:this.lastScrollTop=i.scrollTop,this.handleScrollBound=this.handleScroll.bind(this),this.isTabletMode||this.isScrollPage?(window.addEventListener("scroll",this.handleScrollBound,{passive:!0}),this.isTabletMode||this.updateHeaderFooterVisibility()):this.showHeaderFooter(),this.isInitialized=!0}getFooterOffset(){return this.isTabletMode?0:this.footer&&this.footer.classList.contains("hidden")?this.headerFooterHeight:0}}export{u as S,d as a};
